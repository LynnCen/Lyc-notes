import{_ as a,c as i,o as t,a7 as n}from"./chunks/framework.BQb8NfN9.js";const c=JSON.parse('{"title":"K 近邻算法（KNN）与距离度量","description":"","frontmatter":{},"headers":[],"relativePath":"ai/机器学习/07KNN.md","filePath":"ai/机器学习/07KNN.md","lastUpdated":1770992904000}'),e={name:"ai/机器学习/07KNN.md"};function l(r,s,h,d,p,k){return t(),i("div",null,s[0]||(s[0]=[n(`<h1 id="k-近邻算法-knn-与距离度量" tabindex="-1">K 近邻算法（KNN）与距离度量 <a class="header-anchor" href="#k-近邻算法-knn-与距离度量" aria-label="Permalink to &quot;K 近邻算法（KNN）与距离度量&quot;">​</a></h1><blockquote><p><strong>核心思想</strong>：物以类聚，人以群分 —— 通过样本周边 (k) 个最近邻的类别进行投票，从而判断样本属性。</p></blockquote><hr><h2 id="一、knn-算法入门" tabindex="-1">一、KNN 算法入门 <a class="header-anchor" href="#一、knn-算法入门" aria-label="Permalink to &quot;一、KNN 算法入门&quot;">​</a></h2><h3 id="_1-例题-运用-knn-进行影片分类" tabindex="-1">1. 例题：运用 KNN 进行影片分类 <a class="header-anchor" href="#_1-例题-运用-knn-进行影片分类" aria-label="Permalink to &quot;1. 例题：运用 KNN 进行影片分类&quot;">​</a></h3><table tabindex="0"><thead><tr><th>项目</th><th>说明</th></tr></thead><tbody><tr><td><strong>特征选择</strong></td><td>搞笑镜头、拥抱镜头、打斗镜头（三个特征维度）</td></tr><tr><td><strong>标签编码</strong></td><td>0：喜剧片 | 1：动作片 | 2：爱情片</td></tr><tr><td><strong>预测目标</strong></td><td>判断 <code>[23, 3, 17]</code>（《唐人街探案》）的电影类型</td></tr></tbody></table><p>算法根据该样本在特征空间中与训练集中各样本的距离，找出最近的 (k) 个邻居，再按多数投票得到预测类别。</p><hr><h3 id="_2-knn-模型-api-介绍" tabindex="-1">2. KNN 模型 API 介绍 <a class="header-anchor" href="#_2-knn-模型-api-介绍" aria-label="Permalink to &quot;2. KNN 模型 API 介绍&quot;">​</a></h3><h4 id="_1-导入分类器" tabindex="-1">（1）导入分类器 <a class="header-anchor" href="#_1-导入分类器" aria-label="Permalink to &quot;（1）导入分类器&quot;">​</a></h4><div class="language-python vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">from</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> sklearn.neighbors </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">import</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> KNeighborsClassifier</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><ul><li>注意包名大小写：<code>KNeighborsClassifier</code> 中 K、N、C 为大写，IDE 可能不会自动补全小写开头的名称。</li></ul><h4 id="_2-准备数据" tabindex="-1">（2）准备数据 <a class="header-anchor" href="#_2-准备数据" aria-label="Permalink to &quot;（2）准备数据&quot;">​</a></h4><ul><li><strong>特征数据</strong>：二维数组/列表，每行一个样本，每列一个特征（如：搞笑、拥抱、打斗镜头数）。</li><li><strong>标签数据</strong>：一维数组，与样本一一对应，取值为类别编码（0/1/2）。</li></ul><h4 id="_3-实例化-knn-模型" tabindex="-1">（3）实例化 KNN 模型 <a class="header-anchor" href="#_3-实例化-knn-模型" aria-label="Permalink to &quot;（3）实例化 KNN 模型&quot;">​</a></h4><div class="language-python vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">knn_cls </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> KNeighborsClassifier(</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">n_neighbors</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">3</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><ul><li><strong><code>n_neighbors</code></strong>：参与投票的最近邻数量 (k)。</li><li>(k) 过小：容易过拟合，对噪声敏感；(k) 过大：容易欠拟合，边界模糊。需结合数据用交叉验证等方式调优。</li></ul><h4 id="_4-训练与预测" tabindex="-1">（4）训练与预测 <a class="header-anchor" href="#_4-训练与预测" aria-label="Permalink to &quot;（4）训练与预测&quot;">​</a></h4><ul><li><strong>训练</strong>：<code>estimator.fit(X, y)</code>，学习“特征 → 标签”的映射（KNN 实质是记住训练集，无显式模型参数）。</li><li><strong>预测</strong>：<code>predict(X_new)</code> 接收待预测样本的特征数组（保持与训练时相同的维度和顺序）。</li></ul><h4 id="_5-应用小结" tabindex="-1">（5）应用小结 <a class="header-anchor" href="#_5-应用小结" aria-label="Permalink to &quot;（5）应用小结&quot;">​</a></h4><ul><li>流程：导入 <code>KNeighborsClassifier</code> → 准备 <code>x</code>、<code>y</code> → 实例化（如 <code>n_neighbors=3</code>）→ <code>fit(x, y)</code> → <code>predict(...)</code>。</li><li>本例中《唐人街探案》<code>[23, 3, 17]</code> 被预测为 <strong>0（喜剧片）</strong>。</li><li>输入特征顺序须与训练一致：搞笑、拥抱、打斗镜头。</li></ul><hr><h2 id="二、代码实践" tabindex="-1">二、代码实践 <a class="header-anchor" href="#二、代码实践" aria-label="Permalink to &quot;二、代码实践&quot;">​</a></h2><h3 id="_1-基本流程-实例化-→-训练-→-预测" tabindex="-1">1. 基本流程：实例化 → 训练 → 预测 <a class="header-anchor" href="#_1-基本流程-实例化-→-训练-→-预测" aria-label="Permalink to &quot;1. 基本流程：实例化 → 训练 → 预测&quot;">​</a></h3><div class="language-python vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">from</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> sklearn.neighbors </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">import</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> KNeighborsClassifier</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 特征矩阵（每行一部电影：搞笑、拥抱、打斗镜头）</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">x </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> [</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    [</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">39</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">31</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">],   </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 功夫熊猫</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    [</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">3</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">65</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">],    </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 叶问</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    [</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">3</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">55</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">],    </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 二次曝光</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    # ... 共 9 部电影</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 标签向量：0-喜剧片，1-动作片，2-爱情片</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">y </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> [</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">...</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 实例化并训练</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">knn_cls </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> KNeighborsClassifier(</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">n_neighbors</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">3</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">knn_cls.fit(x, y)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 预测《唐人街探案》</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">result </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> knn_cls.predict([[</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">23</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">3</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">17</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]])  </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 输出: [0] → 喜剧片</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br></div></div><hr><h3 id="_2-应用案例-knn-电影分类编程实践" tabindex="-1">2. 应用案例：KNN 电影分类编程实践 <a class="header-anchor" href="#_2-应用案例-knn-电影分类编程实践" aria-label="Permalink to &quot;2. 应用案例：KNN 电影分类编程实践&quot;">​</a></h3><h4 id="数据说明" tabindex="-1">数据说明 <a class="header-anchor" href="#数据说明" aria-label="Permalink to &quot;数据说明&quot;">​</a></h4><ul><li>9 部电影，每部 3 个特征：<strong>搞笑镜头、拥抱镜头、打斗镜头</strong>。</li><li>示例： <ul><li>《功夫熊猫》<code>[39, 0, 31]</code> → 喜剧片(0)</li><li>《叶问》<code>[3, 2, 65]</code> → 动作片(1)</li><li>《二次曝光》<code>[2, 3, 55]</code> → 爱情片(2)</li></ul></li></ul><h4 id="常用参数" tabindex="-1">常用参数 <a class="header-anchor" href="#常用参数" aria-label="Permalink to &quot;常用参数&quot;">​</a></h4><table tabindex="0"><thead><tr><th>参数</th><th>含义</th><th>本例</th></tr></thead><tbody><tr><td><code>n_neighbors</code></td><td>最近邻个数 (k)</td><td>3</td></tr><tr><td><code>weights</code></td><td>邻居权重</td><td>默认 <code>&quot;uniform&quot;</code>（等权投票）</td></tr><tr><td><code>metric</code></td><td>距离度量</td><td>默认 <code>&quot;minkowski&quot;</code>（闵可夫斯基）</td></tr></tbody></table><h4 id="预测接口" tabindex="-1">预测接口 <a class="header-anchor" href="#预测接口" aria-label="Permalink to &quot;预测接口&quot;">​</a></h4><ul><li><strong><code>predict()</code></strong>：返回预测类别（如 0、1、2）。</li><li><strong><code>predict_proba()</code></strong>：返回属于各类别的概率，便于分析置信度。</li></ul><h4 id="结果与注意点" tabindex="-1">结果与注意点 <a class="header-anchor" href="#结果与注意点" aria-label="Permalink to &quot;结果与注意点&quot;">​</a></h4><ul><li>测试样本 <code>[23, 3, 17]</code> 预测为 <strong>0（喜剧片）</strong>，由 3 个最近邻投票决定。</li><li>建议： <ul><li>特征做尺度统一（如标准化），避免某一维主导距离。</li><li>用交叉验证选取合适的 (k)。</li><li>划分训练集/测试集评估泛化能力。</li></ul></li><li>KNN 天然支持多分类，无需 One-vs-Rest 等额外策略。</li><li>文件名避免与库冲突（如不用 <code>knn.py</code>），并保持代码分段清晰。</li></ul><hr><h2 id="三、知识小结" tabindex="-1">三、知识小结 <a class="header-anchor" href="#三、知识小结" aria-label="Permalink to &quot;三、知识小结&quot;">​</a></h2><table tabindex="0"><thead><tr><th>知识点</th><th>核心内容</th><th>易混淆点 / 关键细节</th><th>应用示例</th></tr></thead><tbody><tr><td><strong>KNN 原理</strong></td><td>基于“近朱者赤”，用样本周围 (k) 个邻居的类别投票分类</td><td>(k) 需人工设定（如 (k=3)）；默认距离多为欧氏（由 <code>metric</code> 决定）</td><td>用搞笑/动作/爱情镜头数区分喜剧、动作、爱情片</td></tr><tr><td><strong>实现步骤</strong></td><td>① 导入 <code>KNeighborsClassifier</code> ② 准备二维特征 + 一维标签 ③ 实例化、<code>fit</code> ④ <code>predict</code> 预测</td><td>特征必须是二维数组；<code>predict_proba()</code> 返回概率而非类别编码</td><td><code>knn = KNeighborsClassifier(n_neighbors=3)</code> → <code>fit</code> → <code>predict([[20,23,17]])</code></td></tr><tr><td><strong>应用场景</strong></td><td>小规模、低维分类（电影类型、用户画像等）</td><td>高维易受“维度灾难”影响；特征与权重需人工设计</td><td>用“厨房物品”等特征推断读书/烹饪等爱好</td></tr><tr><td><strong>参数调优</strong></td><td><code>n_neighbors</code> 控制模型复杂度</td><td>小 (k) 易过拟合，大 (k) 易欠拟合；默认 5；建议交叉验证选 (k)</td><td>比较 (k=3) 与 (k=5) 的准确率与泛化</td></tr><tr><td><strong>与其他算法</strong></td><td>无显式训练，依赖存储全部数据；计算量随样本数增加</td><td>与决策树：KNN 无树结构；与 SVM：KNN 计算成本随数据线性增长；均可做多分类</td><td>数据量小可用 KNN；特征复杂、需可解释性时可考虑决策树</td></tr></tbody></table><hr><h1 id="距离度量" tabindex="-1">距离度量 <a class="header-anchor" href="#距离度量" aria-label="Permalink to &quot;距离度量&quot;">​</a></h1><h2 id="一、学习目标与四种距离" tabindex="-1">一、学习目标与四种距离 <a class="header-anchor" href="#一、学习目标与四种距离" aria-label="Permalink to &quot;一、学习目标与四种距离&quot;">​</a></h2><ul><li><strong>掌握</strong>：欧氏距离、曼哈顿距离的计算与含义。</li><li><strong>了解</strong>：切比雪夫距离、闵可夫斯基距离的定义与在 KNN 中的作用。</li><li>四种距离均以外文人名命名：Euclidean（欧几里得）、Manhattan（曼哈顿）、Chebyshev（切比雪夫）、Minkowski（闵可夫斯基）。</li></ul><hr><h2 id="二、欧氏距离-euclidean-distance" tabindex="-1">二、欧氏距离（Euclidean Distance） <a class="header-anchor" href="#二、欧氏距离-euclidean-distance" aria-label="Permalink to &quot;二、欧氏距离（Euclidean Distance）&quot;">​</a></h2><ul><li><strong>别称</strong>：欧几里得距离。</li><li><strong>公式</strong>（(n) 维空间）：</li></ul><p>[ d_{\\text{Euclidean}}(\\mathbf{x}, \\mathbf{y}) = \\sqrt{\\sum_{i=1}^{n}(x_i - y_i)^2} ]</p><ul><li><strong>几何意义</strong>：两点之间的直线距离。</li><li><strong>示例</strong>： <ul><li>二维：((1,1)) 与 ((2,2)) → (\\sqrt{(2-1)^2 + (2-1)^2} = \\sqrt{2})。</li><li>三维：在二维基础上加上 (z) 坐标差的平方再开根。</li></ul></li><li>是最直观的空间距离，sklearn 中 <code>metric=&quot;minkowski&quot;, p=2</code> 即欧氏距离。</li></ul><hr><h2 id="三、曼哈顿距离-manhattan-distance" tabindex="-1">三、曼哈顿距离（Manhattan Distance） <a class="header-anchor" href="#三、曼哈顿距离-manhattan-distance" aria-label="Permalink to &quot;三、曼哈顿距离（Manhattan Distance）&quot;">​</a></h2><ul><li><strong>别称</strong>：城市街区距离（City Block Distance）。</li><li><strong>公式</strong>：</li></ul><p>[ d_{\\text{Manhattan}}(\\mathbf{x}, \\mathbf{y}) = \\sum_{i=1}^{n}|x_i - y_i| ]</p><ul><li><strong>几何意义</strong>：只能沿坐标轴行走时的路径长度（横平竖直），如城市网格道路。</li><li><strong>示例</strong>：((1,1)) 到 ((2,2)) → (|2-1| + |2-1| = 2)。</li><li><strong>与欧氏关系</strong>：同一对点上，曼哈顿距离 ≥ 欧氏距离；在直角路径下，红蓝两条直角路径等长。</li></ul><hr><h2 id="四、切比雪夫距离-chebyshev-distance" tabindex="-1">四、切比雪夫距离（Chebyshev Distance） <a class="header-anchor" href="#四、切比雪夫距离-chebyshev-distance" aria-label="Permalink to &quot;四、切比雪夫距离（Chebyshev Distance）&quot;">​</a></h2><ul><li><strong>典型应用</strong>：国际象棋中国王的移动步数（可直行、横行、斜行，一步到相邻 8 格之一）。</li><li><strong>公式</strong>：取各维坐标差绝对值的最大值：</li></ul><p>[ d_{\\text{Chebyshev}}(\\mathbf{x}, \\mathbf{y}) = \\max_i |x_i - y_i| ]</p><ul><li><strong>示例</strong>：((0,0)) 到 ((3,4)) → (\\max(3, 4) = 4) 步。</li></ul><hr><h2 id="五、闵可夫斯基距离-minkowski-distance" tabindex="-1">五、闵可夫斯基距离（Minkowski Distance） <a class="header-anchor" href="#五、闵可夫斯基距离-minkowski-distance" aria-label="Permalink to &quot;五、闵可夫斯基距离（Minkowski Distance）&quot;">​</a></h2><ul><li><strong>作用</strong>：用同一公式统一表示上述多种距离。</li><li><strong>公式</strong>：</li></ul><p>[ d_{\\text{Minkowski}}(\\mathbf{x}, \\mathbf{y}; p) = \\left( \\sum_{i=1}^{n}|x_i - y_i|^p \\right)^{1/p} ]</p><ul><li><strong>参数与对应关系</strong>：</li></ul><table tabindex="0"><thead><tr><th>(p)</th><th>对应距离</th></tr></thead><tbody><tr><td>(p=1)</td><td>曼哈顿距离</td></tr><tr><td>(p=2)</td><td>欧氏距离</td></tr><tr><td>(p \\to \\infty)</td><td>切比雪夫距离（极限形式为 (\\max_i</td></tr></tbody></table><p>sklearn 中 KNN 默认 <code>metric=&quot;minkowski&quot;</code>，常配合 <code>p=2</code> 使用。</p><hr><h2 id="六、闵可夫斯基例题" tabindex="-1">六、闵可夫斯基例题 <a class="header-anchor" href="#六、闵可夫斯基例题" aria-label="Permalink to &quot;六、闵可夫斯基例题&quot;">​</a></h2><p><strong>题目</strong>：下列哪个是闵可夫斯基距离的通用表达式？</p><ul><li>A：(p=1) 时的形式（曼哈顿）</li><li>B：(p=2) 时的形式（欧氏）</li><li>C：(p\\to\\infty) 时的形式（切比雪夫）</li><li>D：非标准距离表达式</li></ul><p><strong>答案</strong>：选 <strong>D</strong>。题目问的是“通用表达式”，A/B/C 都是特例，只有闵可夫斯基通式 (d = \\big(\\sum |x_i - y_i|^p\\big)^{1/p}) 才是通用；若 D 描述的是该通式，则选 D，否则根据选项表述判断。考点在于区分“通式”与“特例”。</p><hr><h2 id="七、距离度量小结表" tabindex="-1">七、距离度量小结表 <a class="header-anchor" href="#七、距离度量小结表" aria-label="Permalink to &quot;七、距离度量小结表&quot;">​</a></h2><table tabindex="0"><thead><tr><th>知识点</th><th>核心内容</th><th>考试/易错点</th><th>难度</th></tr></thead><tbody><tr><td><strong>欧氏距离</strong></td><td>直线距离，差方和开根 (\\sqrt{\\sum(x_i-y_i)^2})</td><td>常写为“欧几里得距离”；适用于任意 (n) 维</td><td>⭐⭐</td></tr><tr><td><strong>曼哈顿距离</strong></td><td>城市街区距离，绝对误差之和 (\\sum</td><td>x_i-y_i</td><td>)</td></tr><tr><td><strong>切比雪夫距离</strong></td><td>棋盘王移动，取绝对误差最大值 (\\max_i</td><td>x_i-y_i</td><td>)</td></tr><tr><td><strong>闵可夫斯基距离</strong></td><td>通式 (\\big(\\sum</td><td>x_i-y_i</td><td>^p\\big)^{1/p})，(p=1/2/\\infty) 对应以上三种</td></tr><tr><td><strong>对比与选择</strong></td><td>欧氏：平方和开根；曼哈顿：绝对和；切比雪夫：最大值</td><td>题目常给四个坐标点，要求选对公式或算距离</td><td>⭐⭐⭐</td></tr></tbody></table><hr><h1 id="鸢尾花实战与超参数调优" tabindex="-1">鸢尾花实战与超参数调优 <a class="header-anchor" href="#鸢尾花实战与超参数调优" aria-label="Permalink to &quot;鸢尾花实战与超参数调优&quot;">​</a></h1><h2 id="一、鸢尾花数据集" tabindex="-1">一、鸢尾花数据集 <a class="header-anchor" href="#一、鸢尾花数据集" aria-label="Permalink to &quot;一、鸢尾花数据集&quot;">​</a></h2><h3 id="_1-1-数据集介绍" tabindex="-1">1.1 数据集介绍 <a class="header-anchor" href="#_1-1-数据集介绍" aria-label="Permalink to &quot;1.1 数据集介绍&quot;">​</a></h3><table tabindex="0"><thead><tr><th>项目</th><th>说明</th></tr></thead><tbody><tr><td><strong>规模</strong></td><td>150 条样本，每类 50 条，3 类均匀分布</td></tr><tr><td><strong>类别</strong></td><td>山鸢尾(Iris Setosa)、变色鸢尾(Iris versicolor)、弗吉尼亚鸢尾(Iris Virginica)</td></tr><tr><td><strong>特征</strong></td><td>4 个：花萼长度/宽度(sepal length/width)、花瓣长度/宽度(petal length/width)，单位 cm</td></tr><tr><td><strong>记忆</strong></td><td>p 开头是花瓣(petal)，其余是花萼(sepal)</td></tr></tbody></table><p>分类依据：通过花瓣和花萼的形态差异区分三个品种。示例：山鸢尾 花萼 5.1×3.5 cm、花瓣 1.4×0.2 cm；变色鸢尾 花萼 6.4×3.5 cm、花瓣 4.5×1.2 cm；弗吉尼亚鸢尾 花萼 5.9×3.0 cm、花瓣 5.0×1.8 cm。</p><h3 id="_1-2-数据加载与属性" tabindex="-1">1.2 数据加载与属性 <a class="header-anchor" href="#_1-2-数据加载与属性" aria-label="Permalink to &quot;1.2 数据加载与属性&quot;">​</a></h3><ul><li><strong>加载</strong>：<code>load_iris()</code>，必须带括号调用。</li><li><strong>常用属性</strong>：</li></ul><table tabindex="0"><thead><tr><th>属性</th><th>含义</th></tr></thead><tbody><tr><td><code>.data</code></td><td>特征矩阵 150×4</td></tr><tr><td><code>.target</code></td><td>标签数组，取值 0/1/2</td></tr><tr><td><code>.feature_names</code></td><td>特征名称（含单位，如 <code>&#39;sepal length (cm)&#39;</code>）</td></tr><tr><td><code>.target_names</code></td><td>类别名称</td></tr><tr><td><code>.DESCR</code></td><td>数据集描述与统计信息</td></tr></tbody></table><div class="language-python vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">from</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> sklearn.datasets </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">import</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> load_iris</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">iris_data </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> load_iris()</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">print</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(iris_data.data[:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">5</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">])</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">print</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(iris_data.target)</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">print</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(iris_data.feature_names)</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">print</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(iris_data.target_names)</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><h3 id="_1-3-转为-dataframe-与可视化" tabindex="-1">1.3 转为 DataFrame 与可视化 <a class="header-anchor" href="#_1-3-转为-dataframe-与可视化" aria-label="Permalink to &quot;1.3 转为 DataFrame 与可视化&quot;">​</a></h3><ul><li><strong>转换</strong>：<code>pd.DataFrame(iris_data.data, columns=iris_data.feature_names)</code>，列名需与 <code>feature_names</code> 完全一致（含空格、单位、英文括号）。</li><li><strong>添加标签</strong>：<code>iris_df[&#39;label&#39;] = iris_data.target</code>。</li><li><strong>绘图</strong>：<code>seaborn.lmplot(x, y, data=iris_df, hue=&#39;label&#39;, fit_reg=False)</code>。<code>hue</code> 按类别着色；<code>fit_reg=False</code> 关闭回归线。</li></ul><hr><h2 id="二、knn-鸢尾花分类流程" tabindex="-1">二、KNN 鸢尾花分类流程 <a class="header-anchor" href="#二、knn-鸢尾花分类流程" aria-label="Permalink to &quot;二、KNN 鸢尾花分类流程&quot;">​</a></h2><h3 id="_2-1-整体流程" tabindex="-1">2.1 整体流程 <a class="header-anchor" href="#_2-1-整体流程" aria-label="Permalink to &quot;2.1 整体流程&quot;">​</a></h3><ol><li>获取数据集：<code>load_iris()</code></li><li>数据基本处理：划分训练/测试集</li><li>特征工程：标准化（StandardScaler）</li><li>模型训练：KNeighborsClassifier</li><li>模型预测与评估：predict / score / accuracy_score</li></ol><h3 id="_2-2-依赖与数据划分" tabindex="-1">2.2 依赖与数据划分 <a class="header-anchor" href="#_2-2-依赖与数据划分" aria-label="Permalink to &quot;2.2 依赖与数据划分&quot;">​</a></h3><div class="language-python vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">from</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> sklearn.datasets </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">import</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> load_iris</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">from</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> sklearn.model_selection </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">import</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> train_test_split</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">from</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> sklearn.preprocessing </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">import</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> StandardScaler</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">from</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> sklearn.neighbors </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">import</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> KNeighborsClassifier</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">from</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> sklearn.metrics </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">import</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> accuracy_score</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">import</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> pandas </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">as</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> pd</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">import</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> matplotlib.pyplot </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">as</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> plt</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">import</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> seaborn </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">as</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> sns</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">iris_data </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> load_iris()</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">X_train, X_test, y_train, y_test </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> train_test_split(</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    iris_data.data, iris_data.target, </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">test_size</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0.2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">random_state</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">22</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br></div></div><h3 id="_2-3-标准化-重要" tabindex="-1">2.3 标准化（重要） <a class="header-anchor" href="#_2-3-标准化-重要" aria-label="Permalink to &quot;2.3 标准化（重要）&quot;">​</a></h3><table tabindex="0"><thead><tr><th>方法</th><th>用途</th><th>使用场景</th></tr></thead><tbody><tr><td><code>fit</code></td><td>只计算统计量（如均值、方差）</td><td>仅拟合计</td></tr><tr><td><code>fit_transform</code></td><td>计算并转换</td><td><strong>训练集</strong></td></tr><tr><td><code>transform</code></td><td>用已有统计量转换</td><td><strong>测试集</strong>（避免数据泄露）</td></tr></tbody></table><div class="language-python vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">scaler </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> StandardScaler()</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">x_train </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> scaler.fit_transform(X_train)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">x_test </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> scaler.transform(X_test)   </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 测试集只用 transform</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><h3 id="_2-4-模型训练与预测" tabindex="-1">2.4 模型训练与预测 <a class="header-anchor" href="#_2-4-模型训练与预测" aria-label="Permalink to &quot;2.4 模型训练与预测&quot;">​</a></h3><div class="language-python vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">model </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> KNeighborsClassifier(</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">n_neighbors</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">3</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)  </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 或 5 等</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">model.fit(x_train, y_train)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">y_pred </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> model.predict(x_test)</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 或 model.predict_proba(x_test) 得到概率</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">acc </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> accuracy_score(y_test, y_pred)   </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 或 model.score(x_test, y_test)</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><ul><li><strong>predict</strong>：返回类别标签；<strong>predict_proba</strong>：返回各类别概率（每行和为 1）。</li><li>新数据预测前必须用<strong>同一 scaler</strong> 做 <code>transform</code>。</li></ul><h3 id="_2-5-特征关系与选择" tabindex="-1">2.5 特征关系与选择 <a class="header-anchor" href="#_2-5-特征关系与选择" aria-label="Permalink to &quot;2.5 特征关系与选择&quot;">​</a></h3><ul><li>花瓣长度 + 花瓣宽度：类别更集中、边界更清晰，与 DESCR 中高相关性一致。</li><li>花萼长度 + 花瓣宽度：第 0 类易分，第 1、2 类有重叠。</li><li>可通过多组特征组合 + 散点图选择区分度更好的特征。</li></ul><hr><h2 id="三、超参数选择-交叉验证与网格搜索" tabindex="-1">三、超参数选择：交叉验证与网格搜索 <a class="header-anchor" href="#三、超参数选择-交叉验证与网格搜索" aria-label="Permalink to &quot;三、超参数选择：交叉验证与网格搜索&quot;">​</a></h2><h3 id="_3-1-交叉验证-cv" tabindex="-1">3.1 交叉验证（CV） <a class="header-anchor" href="#_3-1-交叉验证-cv" aria-label="Permalink to &quot;3.1 交叉验证（CV）&quot;">​</a></h3><ul><li><strong>思想</strong>：将训练集划分为 n 份，轮流用 1 份做验证、其余做训练，共 n 次，取平均得分。</li><li><strong>CV=10</strong>：10 折交叉验证。用于更稳定地评估模型，避免单次划分偶然性。</li></ul><h3 id="_3-2-网格搜索-grid-search" tabindex="-1">3.2 网格搜索（Grid Search） <a class="header-anchor" href="#_3-2-网格搜索-grid-search" aria-label="Permalink to &quot;3.2 网格搜索（Grid Search）&quot;">​</a></h3><ul><li><strong>作用</strong>：在给定超参数候选（如 <code>n_neighbors: [1,3,5,7]</code>）上自动训练评估，选出最优组合。</li><li><strong>与 CV 结合</strong>：每组参数都用交叉验证评分，得到更可靠的最优参数。</li></ul><h3 id="_3-3-gridsearchcv-api" tabindex="-1">3.3 GridSearchCV API <a class="header-anchor" href="#_3-3-gridsearchcv-api" aria-label="Permalink to &quot;3.3 GridSearchCV API&quot;">​</a></h3><table tabindex="0"><thead><tr><th>参数</th><th>含义</th></tr></thead><tbody><tr><td><code>estimator</code></td><td>实例化后的模型（如 KNeighborsClassifier()）</td></tr><tr><td><code>param_grid</code></td><td>字典，如 <code>{&#39;n_neighbors&#39;: [4,5,7,9]}</code></td></tr><tr><td><code>cv</code></td><td>折数，如 4 或 5</td></tr></tbody></table><table tabindex="0"><thead><tr><th>属性</th><th>含义</th></tr></thead><tbody><tr><td><code>best_score_</code></td><td>交叉验证最佳得分</td></tr><tr><td><code>best_estimator_</code></td><td>最优参数对应的模型（<strong>应用时应用此模型</strong>）</td></tr><tr><td><code>cv_results_</code></td><td>每次 CV 的详细结果（可转 DataFrame 存 CSV）</td></tr></tbody></table><p><strong>注意</strong>：<code>estimator.score(X_test, y_test)</code> 是<strong>最后一轮</strong>验证的模型得分，不一定等于 <code>best_score_</code>。应使用 <code>best_estimator_</code> 做最终预测。</p><h3 id="_3-4-代码示例" tabindex="-1">3.4 代码示例 <a class="header-anchor" href="#_3-4-代码示例" aria-label="Permalink to &quot;3.4 代码示例&quot;">​</a></h3><div class="language-python vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">from</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> sklearn.model_selection </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">import</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> GridSearchCV</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">scaler </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> StandardScaler()</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">x_train </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> scaler.fit_transform(X_train)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">x_test </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> scaler.transform(X_test)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">param_grid </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;n_neighbors&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: [</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">4</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">5</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">7</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">9</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]}</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">estimator </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> GridSearchCV(</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    KNeighborsClassifier(), param_grid, </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">cv</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">4</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">estimator.fit(x_train, y_train)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">print</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(estimator.best_score_)</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">print</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(estimator.best_estimator_)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">best_model </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> estimator.best_estimator_</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">acc </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> best_model.score(x_test, y_test)</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br></div></div><hr><h2 id="四、特征预处理与-api-小结" tabindex="-1">四、特征预处理与 API 小结 <a class="header-anchor" href="#四、特征预处理与-api-小结" aria-label="Permalink to &quot;四、特征预处理与 API 小结&quot;">​</a></h2><h3 id="_4-1-归一化与标准化" tabindex="-1">4.1 归一化与标准化 <a class="header-anchor" href="#_4-1-归一化与标准化" aria-label="Permalink to &quot;4.1 归一化与标准化&quot;">​</a></h3><table tabindex="0"><thead><tr><th>方法</th><th>公式</th><th>API</th><th>特点</th></tr></thead><tbody><tr><td>归一化</td><td>(x−min)/(max−min)，缩放到 [0,1]</td><td>MinMaxScaler</td><td>受极值影响大</td></tr><tr><td>标准化</td><td>(x−μ)/σ，均值为 0、方差为 1</td><td>StandardScaler</td><td>更鲁棒，常用</td></tr></tbody></table><h3 id="_4-2-api-小结" tabindex="-1">4.2 API 小结 <a class="header-anchor" href="#_4-2-api-小结" aria-label="Permalink to &quot;4.2 API 小结&quot;">​</a></h3><ul><li>分类：<code>KNeighborsClassifier(n_neighbors=5)</code></li><li>回归：<code>KNeighborsRegressor(n_neighbors=5)</code></li><li>预处理：<code>StandardScaler()</code> / <code>MinMaxScaler()</code>；测试集只用 <code>transform</code>。</li></ul><hr><h2 id="五、知识小结-鸢尾花与调参" tabindex="-1">五、知识小结（鸢尾花与调参） <a class="header-anchor" href="#五、知识小结-鸢尾花与调参" aria-label="Permalink to &quot;五、知识小结（鸢尾花与调参）&quot;">​</a></h2><table tabindex="0"><thead><tr><th>知识点</th><th>核心内容</th><th>易混淆点 / 注意</th><th>难度</th></tr></thead><tbody><tr><td>鸢尾花数据集</td><td>150 条、3 类、4 特征（花萼/花瓣长宽）；p=花瓣</td><td>类别名、特征名与 feature_names 对应</td><td>⭐⭐</td></tr><tr><td>数据加载与格式</td><td>load_iris() 必须加括号；DataFrame 列名与 feature_names 一致</td><td>中英文符号、空格、单位</td><td>⭐⭐</td></tr><tr><td>数据可视化</td><td>sns.lmplot(x, y, data, hue=&#39;label&#39;, fit_reg=False)</td><td>hue 为字符串列名；plt.xlabel 不是 xLabel</td><td>⭐⭐⭐</td></tr><tr><td>标准化</td><td>训练集 fit_transform，测试集 transform</td><td>测试集不重新 fit，避免泄露</td><td>⭐⭐⭐</td></tr><tr><td>KNN 训练流程</td><td>加载 → 划分 → 标准化 → 实例化 → fit → predict/score</td><td>新数据预测前要同样标准化</td><td>⭐⭐⭐</td></tr><tr><td>predict vs predict_proba</td><td>predict 返回类别；predict_proba 返回概率（行和为 1）</td><td>评估时区分验证集与测试集</td><td>⭐⭐⭐</td></tr><tr><td>fit/transform/fit_transform</td><td>fit 计算参数，transform 应用参数，fit_transform 计算并应用</td><td>面试高频</td><td>⭐⭐⭐⭐</td></tr><tr><td>交叉验证</td><td>n 折轮流做验证集，取平均得分</td><td>CV 值表示折数</td><td>⭐⭐</td></tr><tr><td>网格搜索</td><td>遍历参数组合，结合 CV 选最优</td><td>param_grid 字典，key 为参数名</td><td>⭐⭐⭐⭐</td></tr><tr><td>GridSearchCV 使用</td><td>best_score_、best_estimator_、cv_results_</td><td>最终用 best_estimator_，不是默认 estimator</td><td>⭐⭐⭐⭐</td></tr></tbody></table><hr><p><em>文档包含 KNN 原理、电影分类、距离度量、鸢尾花实战与超参数调优，便于复习与查阅。</em></p>`,121)]))}const g=a(e,[["render",l]]);export{c as __pageData,g as default};
