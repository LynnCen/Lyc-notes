import{_ as a,c as i,o as n,a8 as l}from"./chunks/framework.n3V8RT1I.js";const c=JSON.parse('{"title":"08 - AIå·¥å…·å®ç°æŒ‡å—","description":"","frontmatter":{},"headers":[],"relativePath":"project/gaoding/AI+æ™ºèƒ½è®¾è®¡ç¼–è¾‘å™¨æ¶æ„æ–‡æ¡£/08-AIå·¥å…·å®ç°æŒ‡å—.md","filePath":"project/gaoding/AI+æ™ºèƒ½è®¾è®¡ç¼–è¾‘å™¨æ¶æ„æ–‡æ¡£/08-AIå·¥å…·å®ç°æŒ‡å—.md","lastUpdated":1768921626000}'),p={name:"project/gaoding/AI+æ™ºèƒ½è®¾è®¡ç¼–è¾‘å™¨æ¶æ„æ–‡æ¡£/08-AIå·¥å…·å®ç°æŒ‡å—.md"};function e(t,s,h,k,r,E){return n(),i("div",null,s[0]||(s[0]=[l(`<h1 id="_08-aiå·¥å…·å®ç°æŒ‡å—" tabindex="-1">08 - AIå·¥å…·å®ç°æŒ‡å— <a class="header-anchor" href="#_08-aiå·¥å…·å®ç°æŒ‡å—" aria-label="Permalink to &quot;08 - AIå·¥å…·å®ç°æŒ‡å—&quot;">â€‹</a></h1><blockquote><p><strong>å¯¼èˆª</strong>ï¼š<a href="./README">ğŸ“š è¿”å›æ€»ç›®å½•</a> | <a href="./07-Agentå·¥ä½œæµç¨‹">â¬…ï¸ ä¸Šä¸€ç¯‡ï¼šAgentå·¥ä½œæµç¨‹</a> | <a href="./08-æ€§èƒ½ä¼˜åŒ–ä¸é”™è¯¯å¤„ç†">â¡ï¸ ä¸‹ä¸€ç¯‡ï¼šæ€§èƒ½ä¼˜åŒ–ä¸é”™è¯¯å¤„ç†</a></p><p><strong>æ‰€å±</strong>ï¼šAI+ æ™ºèƒ½è®¾è®¡ç¼–è¾‘å™¨æ¶æ„æ–‡æ¡£</p><p><strong>æ ¸å¿ƒä»·å€¼</strong>ï¼šå­¦ä¹ å„ç§AIå·¥å…·çš„å‰ç«¯å®ç°æµç¨‹å’Œå…³é”®æŠ€æœ¯</p></blockquote><hr><h2 id="ä¸€ã€aiå·¥å…·å…¨æ™¯" tabindex="-1">ä¸€ã€AIå·¥å…·å…¨æ™¯ <a class="header-anchor" href="#ä¸€ã€aiå·¥å…·å…¨æ™¯" aria-label="Permalink to &quot;ä¸€ã€AIå·¥å…·å…¨æ™¯&quot;">â€‹</a></h2><p>ç³»ç»Ÿæä¾›äº†<strong>10+ç§AIå·¥å…·</strong>ï¼ŒæŒ‰åŠŸèƒ½åˆ†ä¸ºä¸‰å¤§ç±»ï¼š</p><h3 id="_1-1-å·¥å…·åˆ†ç±»" tabindex="-1">1.1 å·¥å…·åˆ†ç±» <a class="header-anchor" href="#_1-1-å·¥å…·åˆ†ç±»" aria-label="Permalink to &quot;1.1 å·¥å…·åˆ†ç±»&quot;">â€‹</a></h3><table tabindex="0"><thead><tr><th>ç±»åˆ«</th><th>å·¥å…·</th><th>åŠŸèƒ½</th><th>å…¸å‹åœºæ™¯</th></tr></thead><tbody><tr><td><strong>ç”Ÿæˆç±»</strong></td><td>AIæŠ å›¾</td><td>è‡ªåŠ¨åˆ†ç¦»å‰æ™¯ä¸èƒŒæ™¯</td><td>å»é™¤äº§å“å›¾èƒŒæ™¯</td></tr><tr><td></td><td>AIæ»¤é•œ</td><td>å›¾ç‰‡é£æ ¼è½¬æ¢</td><td>å°†ç…§ç‰‡è½¬æˆæ²¹ç”»é£æ ¼</td></tr><tr><td></td><td>è½¬çŸ¢é‡</td><td>ä½å›¾è½¬çŸ¢é‡</td><td>Logoè½¬å¯ç¼©æ”¾çš„çŸ¢é‡å›¾</td></tr><tr><td><strong>ç¼–è¾‘ç±»</strong></td><td>AIæ”¹å›¾</td><td>å±€éƒ¨æ›¿æ¢å†…å®¹</td><td>æŠŠçº¢è‰²æ±½è½¦æ”¹æˆè“è‰²</td></tr><tr><td></td><td>AIæ¶ˆé™¤</td><td>æ™ºèƒ½å»é™¤ç‰©ä½“</td><td>ç§»é™¤ç…§ç‰‡ä¸­çš„è·¯äºº</td></tr><tr><td></td><td>AIæ‰©å›¾</td><td>æ™ºèƒ½æ‰©å±•è¾¹ç•Œ</td><td>å°†16:9çš„å›¾æ‰©å±•æˆ1:1</td></tr><tr><td></td><td>AIå˜æ¸…æ™°</td><td>å›¾ç‰‡è¶…åˆ†è¾¨ç‡</td><td>ä½æ¸…å›¾ç‰‡å˜é«˜æ¸…</td></tr><tr><td><strong>åˆ†æç±»</strong></td><td>å›¾æ–‡åˆ†å±‚</td><td>è‡ªåŠ¨è¯†åˆ«æ–‡å­—å’Œå›¾å½¢</td><td>å°†æµ·æŠ¥æ‹†åˆ†æˆå¯ç¼–è¾‘çš„æ¨¡æ¿</td></tr><tr><td></td><td>æº¶å›¾</td><td>å›¾ç‰‡èåˆ</td><td>å°†ä¸¤å¼ å›¾è‡ªç„¶èåˆ</td></tr><tr><td></td><td>AIæ¢è„¸</td><td>äººè„¸æ›¿æ¢</td><td>æ›¿æ¢ç…§ç‰‡ä¸­çš„äººè„¸</td></tr><tr><td></td><td>AIé˜´å½±</td><td>è‡ªåŠ¨ç”Ÿæˆé˜´å½±</td><td>ä¸ºæŠ å›¾å…ƒç´ æ·»åŠ çœŸå®é˜´å½±</td></tr></tbody></table><h3 id="_1-2-å·¥å…·æ³¨å†Œ" tabindex="-1">1.2 å·¥å…·æ³¨å†Œ <a class="header-anchor" href="#_1-2-å·¥å…·æ³¨å†Œ" aria-label="Permalink to &quot;1.2 å·¥å…·æ³¨å†Œ&quot;">â€‹</a></h3><div class="language-typescript vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">typescript</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// domains/editor/extensions/ai/src/hooks/use-image-actions.ts</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">export</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> function</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> useImageActions</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">() {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> actions</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">:</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> IAction</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">[] </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> [</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      name: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;openInMatting&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,          </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// æŠ å›¾</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      title: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;AI æŠ å›¾&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">      filter</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: () </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=&gt;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> true</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,             </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// æ€»æ˜¯å¯ç”¨</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      valid,                          </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// å…ƒç´ éªŒè¯å‡½æ•°</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    },</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      name: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;openInPaintReplace&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,     </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// æ”¹å›¾</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      title: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;AI æ”¹å›¾&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      filter: </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">createFilter</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;inPaintReplaceV2&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">),  </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// æƒé™æ§åˆ¶</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      valid,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    },</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      name: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;openInPaintRemove&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,      </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// æ¶ˆé™¤</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      title: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;AI æ¶ˆé™¤&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">      filter</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: () </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=&gt;</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> !!</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">createFilter</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;inPaintRemove&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">||</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> createFilter</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;inPaintRemoveV2&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)),</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      valid,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    },</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    // ... å…¶ä»–å·¥å…·</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  ];</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  return</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> { actions, handleClickAction };</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br></div></div><p><strong>å…³é”®è®¾è®¡</strong>ï¼š</p><ul><li><code>filter</code>ï¼šæƒé™æ§åˆ¶ï¼ˆæ˜¯å¦å¯ç”¨è¯¥å·¥å…·ï¼‰</li><li><code>valid</code>ï¼šå…ƒç´ éªŒè¯ï¼ˆå½“å‰å…ƒç´ æ˜¯å¦å¯ä½¿ç”¨è¯¥å·¥å…·ï¼‰</li><li><code>cover</code>ï¼šå·¥å…·çš„é¢„è§ˆå°é¢ï¼ˆé™æ€å›¾å’Œè§†é¢‘ï¼‰</li></ul><hr><h2 id="äºŒã€aiæŠ å›¾-è‡ªåŠ¨åˆ†ç¦»å‰æ™¯ä¸èƒŒæ™¯" tabindex="-1">äºŒã€AIæŠ å›¾ï¼šè‡ªåŠ¨åˆ†ç¦»å‰æ™¯ä¸èƒŒæ™¯ <a class="header-anchor" href="#äºŒã€aiæŠ å›¾-è‡ªåŠ¨åˆ†ç¦»å‰æ™¯ä¸èƒŒæ™¯" aria-label="Permalink to &quot;äºŒã€AIæŠ å›¾ï¼šè‡ªåŠ¨åˆ†ç¦»å‰æ™¯ä¸èƒŒæ™¯&quot;">â€‹</a></h2><h3 id="_2-1-åŠŸèƒ½æè¿°" tabindex="-1">2.1 åŠŸèƒ½æè¿° <a class="header-anchor" href="#_2-1-åŠŸèƒ½æè¿°" aria-label="Permalink to &quot;2.1 åŠŸèƒ½æè¿°&quot;">â€‹</a></h3><p><strong>è¾“å…¥</strong>ï¼šå¸¦èƒŒæ™¯çš„å›¾ç‰‡<br><strong>è¾“å‡º</strong>ï¼šé€æ˜èƒŒæ™¯çš„å‰æ™¯å›¾ï¼ˆPNGï¼‰</p><p><strong>å…¸å‹åœºæ™¯</strong>ï¼š</p><ul><li>äº§å“æ‹æ‘„å›¾å»é™¤èƒŒæ™¯</li><li>äººç‰©ç…§ç‰‡æå–ä¸»ä½“</li><li>Logoç´ æå¤„ç†</li></ul><h3 id="_2-2-å®ç°æµç¨‹" tabindex="-1">2.2 å®ç°æµç¨‹ <a class="header-anchor" href="#_2-2-å®ç°æµç¨‹" aria-label="Permalink to &quot;2.2 å®ç°æµç¨‹&quot;">â€‹</a></h3><div class="language- vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>ç”¨æˆ·æ“ä½œæµç¨‹ï¼š</span></span>
<span class="line"><span>1. é€‰ä¸­å›¾ç‰‡å…ƒç´ </span></span>
<span class="line"><span>2. ç‚¹å‡»å³ä¾§é¢æ¿&quot;AIæŠ å›¾&quot;æŒ‰é’®</span></span>
<span class="line"><span>3. ç³»ç»Ÿè‡ªåŠ¨å‘èµ·æŠ å›¾è¯·æ±‚</span></span>
<span class="line"><span>4. æ˜¾ç¤ºåŠ è½½çŠ¶æ€</span></span>
<span class="line"><span>5. æŠ å›¾å®Œæˆï¼Œæ›¿æ¢ä¸ºé€æ˜èƒŒæ™¯å›¾</span></span>
<span class="line"><span>6. ç”¨æˆ·å¯ä»¥è°ƒæ•´å‚æ•°é‡æ–°æŠ å›¾</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><h3 id="_2-3-å…³é”®æŠ€æœ¯" tabindex="-1">2.3 å…³é”®æŠ€æœ¯ <a class="header-anchor" href="#_2-3-å…³é”®æŠ€æœ¯" aria-label="Permalink to &quot;2.3 å…³é”®æŠ€æœ¯&quot;">â€‹</a></h3><p><strong>æ ¸å¿ƒAPIè°ƒç”¨</strong>ï¼š</p><div class="language-typescript vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">typescript</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// è°ƒç”¨æŠ å›¾æ¥å£</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> result</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> await</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> fetch</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;/api/ai/matting&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  method: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;POST&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  body: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">JSON</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">stringify</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">({</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    image_url: element.imageUrl,  </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// åŸå›¾URL</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    algorithm: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;u2net&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,            </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// æˆ– &#39;modnet&#39;ï¼ˆäººåƒä¸“ç”¨ï¼‰</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  }),</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">});</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// è¿”å›ç»“æœ</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">{</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">  &quot;matted_url&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;https://cdn.com/matted-image.png&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,  </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// æŠ å›¾åçš„URL</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">  &quot;mask&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;https://cdn.com/mask.png&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,                </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// è’™ç‰ˆï¼ˆå¯é€‰ï¼‰</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br></div></div><p><strong>å‰ç«¯å¤„ç†</strong>ï¼š</p><div class="language-typescript vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">typescript</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// 1. è§¦å‘æŠ å›¾</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">postMessage</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">({ type: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;openInMatting&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> });</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// 2. ç›‘å¬æŠ å›¾ç»“æœ</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">events.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">on</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;mattingCompleted&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, (</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">result</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">  // æ›´æ–°å…ƒç´ å›¾ç‰‡URL</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  editor.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">updateElement</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(element, {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    imageUrl: result.matted_url,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    mask: result.mask,  </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// ä¿å­˜è’™ç‰ˆç”¨äºåç»­ç¼–è¾‘</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  });</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">  // ä¿å­˜æ“ä½œè®°å½•</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  aiRecordsService.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">addRecord</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">({</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    tool_type: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;matting&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    origin_url: element.imageUrl,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    result_url: result.matted_url,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    element_id: element.id,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  });</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">});</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br></div></div><p><strong>ç®—æ³•é€‰æ‹©</strong>ï¼š</p><ul><li><code>u2net</code>ï¼šé€šç”¨ç®—æ³•ï¼Œé€‚åˆå„ç§ç‰©ä½“</li><li><code>modnet</code>ï¼šäººåƒä¸“ç”¨ï¼Œè¾¹ç¼˜æ›´ç²¾ç»†</li></ul><hr><h2 id="ä¸‰ã€aiæ”¹å›¾-å±€éƒ¨å†…å®¹æ›¿æ¢" tabindex="-1">ä¸‰ã€AIæ”¹å›¾ï¼šå±€éƒ¨å†…å®¹æ›¿æ¢ <a class="header-anchor" href="#ä¸‰ã€aiæ”¹å›¾-å±€éƒ¨å†…å®¹æ›¿æ¢" aria-label="Permalink to &quot;ä¸‰ã€AIæ”¹å›¾ï¼šå±€éƒ¨å†…å®¹æ›¿æ¢&quot;">â€‹</a></h2><h3 id="_3-1-åŠŸèƒ½æè¿°" tabindex="-1">3.1 åŠŸèƒ½æè¿° <a class="header-anchor" href="#_3-1-åŠŸèƒ½æè¿°" aria-label="Permalink to &quot;3.1 åŠŸèƒ½æè¿°&quot;">â€‹</a></h3><p><strong>è¾“å…¥</strong>ï¼šå›¾ç‰‡ + è’™ç‰ˆåŒºåŸŸ + æç¤ºè¯<br><strong>è¾“å‡º</strong>ï¼šå±€éƒ¨æ›¿æ¢åçš„å›¾ç‰‡</p><p><strong>å…¸å‹åœºæ™¯</strong>ï¼š</p><ul><li>æ”¹å˜ç‰©ä½“é¢œè‰²ï¼š&quot;æŠŠçº¢è‰²æ±½è½¦æ”¹æˆè“è‰²&quot;</li><li>æ›¿æ¢èƒŒæ™¯ï¼š&quot;æŠŠå®¤å†…èƒŒæ™¯æ”¹æˆæµ·è¾¹&quot;</li><li>ä¿®æ”¹ç»†èŠ‚ï¼š&quot;æŠŠçœ¼ç›å˜å¤§ä¸€ç‚¹&quot;</li></ul><h3 id="_3-2-å®ç°æµç¨‹" tabindex="-1">3.2 å®ç°æµç¨‹ <a class="header-anchor" href="#_3-2-å®ç°æµç¨‹" aria-label="Permalink to &quot;3.2 å®ç°æµç¨‹&quot;">â€‹</a></h3><div class="language- vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>ç”¨æˆ·æ“ä½œæµç¨‹ï¼š</span></span>
<span class="line"><span>1. é€‰ä¸­å›¾ç‰‡å…ƒç´ </span></span>
<span class="line"><span>2. ç‚¹å‡»&quot;AIæ”¹å›¾&quot;</span></span>
<span class="line"><span>3. ç”¨æˆ·æ¶‚æŠ¹è¦ä¿®æ”¹çš„åŒºåŸŸï¼ˆç”Ÿæˆè’™ç‰ˆï¼‰</span></span>
<span class="line"><span>4. è¾“å…¥ä¿®æ”¹æç¤ºè¯ï¼š&quot;æ”¹æˆè“è‰²&quot;</span></span>
<span class="line"><span>5. ç‚¹å‡»ç¡®è®¤</span></span>
<span class="line"><span>6. ç³»ç»Ÿå‘èµ·æ”¹å›¾è¯·æ±‚</span></span>
<span class="line"><span>7. æ˜¾ç¤ºåŠ è½½çŠ¶æ€</span></span>
<span class="line"><span>8. æ”¹å›¾å®Œæˆï¼ŒåŸåœ°æ›¿æ¢</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><h3 id="_3-3-å…³é”®æŠ€æœ¯" tabindex="-1">3.3 å…³é”®æŠ€æœ¯ <a class="header-anchor" href="#_3-3-å…³é”®æŠ€æœ¯" aria-label="Permalink to &quot;3.3 å…³é”®æŠ€æœ¯&quot;">â€‹</a></h3><p><strong>è’™ç‰ˆç»˜åˆ¶</strong>ï¼š</p><div class="language-typescript vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">typescript</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// ç”¨æˆ·æ¶‚æŠ¹åŒºåŸŸï¼Œç”Ÿæˆè’™ç‰ˆ</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">async</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> function</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> getMaskFromUserSelection</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">() {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">  // 1. æ˜¾ç¤ºæ¶‚æŠ¹å·¥å…·</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> brushTool</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> editor.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">createBrushTool</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">({</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    size: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">20</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,          </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// ç”»ç¬”å¤§å°</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    color: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;#ff0000&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,  </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// çº¢è‰²é«˜äº®</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    opacity: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0.5</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,      </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// åŠé€æ˜</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  });</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">  // 2. ç”¨æˆ·æ¶‚æŠ¹</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> brushStrokes</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> await</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> brushTool.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">waitForUserInput</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">();</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">  // 3. ç”Ÿæˆè’™ç‰ˆï¼ˆé»‘ç™½å›¾ï¼‰</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> mask</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> await</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> generateMaskFromStrokes</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(brushStrokes);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  return</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    mask,              </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// Base64ç¼–ç çš„è’™ç‰ˆå›¾ç‰‡</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    bounds: brushTool.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">getBounds</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(),  </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// æ¶‚æŠ¹åŒºåŸŸçš„è¾¹ç•Œ</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  };</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br></div></div><p><strong>æ ¸å¿ƒAPIè°ƒç”¨</strong>ï¼š</p><div class="language-typescript vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">typescript</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> result</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> await</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> fetch</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;/api/ai/inpaint/replace&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  method: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;POST&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  body: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">JSON</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">stringify</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">({</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    image_url: element.imageUrl,  </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// åŸå›¾</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    mask: maskArea.mask,          </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// è’™ç‰ˆåŒºåŸŸ</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    prompt: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;æ”¹æˆè“è‰²&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,            </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// ä¿®æ”¹æç¤ºè¯</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    strength: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0.8</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,                </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// æ”¹åŠ¨å¼ºåº¦ï¼ˆ0-1ï¼‰</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  }),</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">});</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// è¿”å›ç»“æœ</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">{</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">  &quot;result_url&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;https://cdn.com/modified-image.jpg&quot;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br></div></div><p><strong>å‰ç«¯å¤„ç†</strong>ï¼š</p><div class="language-typescript vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">typescript</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// åŸåœ°æ›¿æ¢å›¾ç‰‡</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">function</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> replaceImageInPlace</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">element</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">newImageUrl</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">  // ä¿å­˜åŸå›¾ä½ç½®å’Œå°ºå¯¸</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  const</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> { </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">x</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">y</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">width</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">height</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">rotation</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> } </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> element.transform;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">  // æ›´æ–°å›¾ç‰‡URLï¼ˆä¿æŒå…¶ä»–å±æ€§ä¸å˜ï¼‰</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  editor.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">updateElement</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(element, {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    imageUrl: newImageUrl,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  });</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">  // æ·¡å…¥åŠ¨ç”»</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">  animateFadeIn</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(element, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">300</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br></div></div><hr><h2 id="å››ã€aiæ¶ˆé™¤-æ™ºèƒ½å»é™¤ç‰©ä½“" tabindex="-1">å››ã€AIæ¶ˆé™¤ï¼šæ™ºèƒ½å»é™¤ç‰©ä½“ <a class="header-anchor" href="#å››ã€aiæ¶ˆé™¤-æ™ºèƒ½å»é™¤ç‰©ä½“" aria-label="Permalink to &quot;å››ã€AIæ¶ˆé™¤ï¼šæ™ºèƒ½å»é™¤ç‰©ä½“&quot;">â€‹</a></h2><h3 id="_4-1-åŠŸèƒ½æè¿°" tabindex="-1">4.1 åŠŸèƒ½æè¿° <a class="header-anchor" href="#_4-1-åŠŸèƒ½æè¿°" aria-label="Permalink to &quot;4.1 åŠŸèƒ½æè¿°&quot;">â€‹</a></h3><p><strong>è¾“å…¥</strong>ï¼šå›¾ç‰‡ + è¦æ¶ˆé™¤çš„åŒºåŸŸ<br><strong>è¾“å‡º</strong>ï¼šæ¶ˆé™¤åçš„å›¾ç‰‡ï¼ˆæ™ºèƒ½å¡«å……ï¼‰</p><p><strong>å…¸å‹åœºæ™¯</strong>ï¼š</p><ul><li>ç§»é™¤ç…§ç‰‡ä¸­çš„è·¯äºº</li><li>å»é™¤å›¾ç‰‡ä¸Šçš„æ°´å°</li><li>åˆ é™¤å¤šä½™çš„ç‰©ä½“</li></ul><h3 id="_4-2-å®ç°æµç¨‹" tabindex="-1">4.2 å®ç°æµç¨‹ <a class="header-anchor" href="#_4-2-å®ç°æµç¨‹" aria-label="Permalink to &quot;4.2 å®ç°æµç¨‹&quot;">â€‹</a></h3><div class="language- vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>ç”¨æˆ·æ“ä½œæµç¨‹ï¼š</span></span>
<span class="line"><span>1. é€‰ä¸­å›¾ç‰‡å…ƒç´ </span></span>
<span class="line"><span>2. ç‚¹å‡»&quot;AIæ¶ˆé™¤&quot;</span></span>
<span class="line"><span>3. ç”¨æˆ·æ¶‚æŠ¹è¦æ¶ˆé™¤çš„åŒºåŸŸ</span></span>
<span class="line"><span>4. ç‚¹å‡»ç¡®è®¤</span></span>
<span class="line"><span>5. ç³»ç»Ÿæ™ºèƒ½å¡«å……æ¶ˆé™¤åŒºåŸŸ</span></span>
<span class="line"><span>6. æ˜¾ç¤ºæ¶ˆé™¤ç»“æœ</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><h3 id="_4-3-å…³é”®æŠ€æœ¯" tabindex="-1">4.3 å…³é”®æŠ€æœ¯ <a class="header-anchor" href="#_4-3-å…³é”®æŠ€æœ¯" aria-label="Permalink to &quot;4.3 å…³é”®æŠ€æœ¯&quot;">â€‹</a></h3><p><strong>æ ¸å¿ƒAPIè°ƒç”¨</strong>ï¼š</p><div class="language-typescript vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">typescript</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> result</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> await</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> fetch</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;/api/ai/inpaint/remove&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  method: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;POST&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  body: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">JSON</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">stringify</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">({</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    image_url: element.imageUrl,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    mask: removeArea.mask,    </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// è¦æ¶ˆé™¤çš„åŒºåŸŸ</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    algorithm: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;lama&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,        </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// æˆ– &#39;telea&#39;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  }),</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">});</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><p><strong>ç®—æ³•é€‰æ‹©</strong>ï¼š</p><ul><li><code>lama</code>ï¼šLaMaç®—æ³•ï¼Œæ•ˆæœæ›´å¥½ï¼Œé€‚åˆå¤æ‚åœºæ™¯</li><li><code>telea</code>ï¼šä¼ ç»Ÿç®—æ³•ï¼Œé€Ÿåº¦å¿«ï¼Œé€‚åˆç®€å•åœºæ™¯</li></ul><hr><h2 id="äº”ã€aiæ‰©å›¾-æ™ºèƒ½æ‰©å±•è¾¹ç•Œ" tabindex="-1">äº”ã€AIæ‰©å›¾ï¼šæ™ºèƒ½æ‰©å±•è¾¹ç•Œ <a class="header-anchor" href="#äº”ã€aiæ‰©å›¾-æ™ºèƒ½æ‰©å±•è¾¹ç•Œ" aria-label="Permalink to &quot;äº”ã€AIæ‰©å›¾ï¼šæ™ºèƒ½æ‰©å±•è¾¹ç•Œ&quot;">â€‹</a></h2><h3 id="_5-1-åŠŸèƒ½æè¿°" tabindex="-1">5.1 åŠŸèƒ½æè¿° <a class="header-anchor" href="#_5-1-åŠŸèƒ½æè¿°" aria-label="Permalink to &quot;5.1 åŠŸèƒ½æè¿°&quot;">â€‹</a></h3><p><strong>è¾“å…¥</strong>ï¼šå›¾ç‰‡ + æ‰©å±•æ–¹å‘ + æ‰©å±•å°ºå¯¸<br><strong>è¾“å‡º</strong>ï¼šæ‰©å±•åçš„å›¾ç‰‡</p><p><strong>å…¸å‹åœºæ™¯</strong>ï¼š</p><ul><li>å°†16:9çš„å›¾æ‰©å±•æˆ1:1</li><li>æ‰©å±•å›¾ç‰‡è¾¹ç¼˜ï¼Œå¢åŠ ç•™ç™½</li><li>æ™ºèƒ½è¡¥å…¨è¢«è£åˆ‡çš„å†…å®¹</li></ul><h3 id="_5-2-å®ç°æµç¨‹" tabindex="-1">5.2 å®ç°æµç¨‹ <a class="header-anchor" href="#_5-2-å®ç°æµç¨‹" aria-label="Permalink to &quot;5.2 å®ç°æµç¨‹&quot;">â€‹</a></h3><div class="language- vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>ç”¨æˆ·æ“ä½œæµç¨‹ï¼š</span></span>
<span class="line"><span>1. é€‰ä¸­å›¾ç‰‡å…ƒç´ </span></span>
<span class="line"><span>2. ç‚¹å‡»&quot;AIæ‰©å›¾&quot;</span></span>
<span class="line"><span>3. é€‰æ‹©æ‰©å±•æ–¹å‘ï¼ˆä¸Š/ä¸‹/å·¦/å³/å…¨éƒ¨ï¼‰</span></span>
<span class="line"><span>4. é€‰æ‹©æ‰©å±•æ¯”ä¾‹ï¼ˆå¦‚20%ï¼‰</span></span>
<span class="line"><span>5. ç‚¹å‡»ç¡®è®¤</span></span>
<span class="line"><span>6. ç³»ç»Ÿæ™ºèƒ½ç”Ÿæˆæ‰©å±•å†…å®¹</span></span>
<span class="line"><span>7. æ˜¾ç¤ºæ‰©å±•ç»“æœ</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><h3 id="_5-3-å…³é”®æŠ€æœ¯" tabindex="-1">5.3 å…³é”®æŠ€æœ¯ <a class="header-anchor" href="#_5-3-å…³é”®æŠ€æœ¯" aria-label="Permalink to &quot;5.3 å…³é”®æŠ€æœ¯&quot;">â€‹</a></h3><p><strong>æ ¸å¿ƒAPIè°ƒç”¨</strong>ï¼š</p><div class="language-typescript vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">typescript</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> result</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> await</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> fetch</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;/api/ai/outpaint/expand&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  method: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;POST&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  body: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">JSON</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">stringify</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">({</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    image_url: element.imageUrl,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    direction: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;all&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,             </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// &#39;left&#39;|&#39;right&#39;|&#39;top&#39;|&#39;bottom&#39;|&#39;all&#39;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    expand_pixels: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">200</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,           </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// æ‰©å±•åƒç´ æ•°</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    prompt: element.context,      </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// ä¸Šä¸‹æ–‡æç¤ºï¼ˆå¯é€‰ï¼‰</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  }),</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">});</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// è¿”å›ç»“æœ</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">{</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">  &quot;result_url&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;https://cdn.com/expanded-image.jpg&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">  &quot;new_width&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">2120</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,    </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// æ‰©å±•åçš„å®½åº¦</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">  &quot;new_height&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1080</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,   </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// æ‰©å±•åçš„é«˜åº¦</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br></div></div><p><strong>å‰ç«¯å¤„ç†</strong>ï¼š</p><div class="language-typescript vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">typescript</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// æ›´æ–°å…ƒç´ å°ºå¯¸å’ŒURL</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">editor.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">updateElement</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(element, {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  imageUrl: result.result_url,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  width: result.new_width,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  height: result.new_height,</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">  // ä¿æŒä¸­å¿ƒä½ç½®ä¸å˜</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  transform: {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    ...</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">element.transform,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    x: element.transform.x </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (result.new_width </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> element.width) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">/</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    y: element.transform.y </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (result.new_height </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> element.height) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">/</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  },</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">});</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br></div></div><hr><h2 id="å…­ã€aiå˜æ¸…æ™°-å›¾ç‰‡è¶…åˆ†è¾¨ç‡" tabindex="-1">å…­ã€AIå˜æ¸…æ™°ï¼šå›¾ç‰‡è¶…åˆ†è¾¨ç‡ <a class="header-anchor" href="#å…­ã€aiå˜æ¸…æ™°-å›¾ç‰‡è¶…åˆ†è¾¨ç‡" aria-label="Permalink to &quot;å…­ã€AIå˜æ¸…æ™°ï¼šå›¾ç‰‡è¶…åˆ†è¾¨ç‡&quot;">â€‹</a></h2><h3 id="_6-1-åŠŸèƒ½æè¿°" tabindex="-1">6.1 åŠŸèƒ½æè¿° <a class="header-anchor" href="#_6-1-åŠŸèƒ½æè¿°" aria-label="Permalink to &quot;6.1 åŠŸèƒ½æè¿°&quot;">â€‹</a></h3><p><strong>è¾“å…¥</strong>ï¼šä½æ¸…å›¾ç‰‡<br><strong>è¾“å‡º</strong>ï¼šé«˜æ¸…å›¾ç‰‡</p><p><strong>å…¸å‹åœºæ™¯</strong>ï¼š</p><ul><li>è€ç…§ç‰‡ä¿®å¤</li><li>æ¨¡ç³Šå›¾ç‰‡å˜æ¸…æ™°</li><li>å°å›¾æ”¾å¤§ä¸å¤±çœŸ</li></ul><h3 id="_6-2-å®ç°æµç¨‹" tabindex="-1">6.2 å®ç°æµç¨‹ <a class="header-anchor" href="#_6-2-å®ç°æµç¨‹" aria-label="Permalink to &quot;6.2 å®ç°æµç¨‹&quot;">â€‹</a></h3><div class="language- vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>ç”¨æˆ·æ“ä½œæµç¨‹ï¼š</span></span>
<span class="line"><span>1. é€‰ä¸­å›¾ç‰‡å…ƒç´ </span></span>
<span class="line"><span>2. ç‚¹å‡»&quot;AIå˜æ¸…æ™°&quot;</span></span>
<span class="line"><span>3. é€‰æ‹©æ”¾å¤§å€æ•°ï¼ˆ2x/4xï¼‰</span></span>
<span class="line"><span>4. ç‚¹å‡»ç¡®è®¤</span></span>
<span class="line"><span>5. ç³»ç»Ÿè¿›è¡Œè¶…åˆ†è¾¨ç‡å¤„ç†</span></span>
<span class="line"><span>6. æ˜¾ç¤ºæ¸…æ™°åŒ–ç»“æœ</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><h3 id="_6-3-å…³é”®æŠ€æœ¯" tabindex="-1">6.3 å…³é”®æŠ€æœ¯ <a class="header-anchor" href="#_6-3-å…³é”®æŠ€æœ¯" aria-label="Permalink to &quot;6.3 å…³é”®æŠ€æœ¯&quot;">â€‹</a></h3><p><strong>æ ¸å¿ƒAPIè°ƒç”¨</strong>ï¼š</p><div class="language-typescript vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">typescript</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// æ£€æŸ¥å›¾ç‰‡åˆ†è¾¨ç‡</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> isLowResolution</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> element.width </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&lt;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 800</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> ||</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> element.height </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&lt;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 800</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">!</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">isLowResolution) {</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">  showToast</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;å›¾ç‰‡åˆ†è¾¨ç‡å·²ç»è¶³å¤Ÿï¼Œæ— éœ€å˜æ¸…æ™°&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  return</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> result</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> await</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> fetch</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;/api/ai/enhance&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  method: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;POST&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  body: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">JSON</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">stringify</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">({</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    image_url: element.imageUrl,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    scale_factor: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,    </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// æ”¾å¤§å€æ•°ï¼ˆ2æˆ–4ï¼‰</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    denoise: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">true</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,      </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// é™å™ª</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    sharpen: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">true</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,      </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// é”åŒ–</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  }),</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">});</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br></div></div><p><strong>å‰ç«¯å¤„ç†</strong>ï¼š</p><div class="language-typescript vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">typescript</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// ä¿æŒåŸå°ºå¯¸æ›´æ–°ï¼ˆä¸æ”¹å˜ç”»å¸ƒä¸Šçš„å¤§å°ï¼‰</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">editor.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">updateElement</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(element, {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  imageUrl: result.url,</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">  // width å’Œ height ä¿æŒä¸å˜</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">});</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><hr><h2 id="ä¸ƒã€å›¾æ–‡åˆ†å±‚-è‡ªåŠ¨è¯†åˆ«æ–‡å­—å’Œå›¾å½¢" tabindex="-1">ä¸ƒã€å›¾æ–‡åˆ†å±‚ï¼šè‡ªåŠ¨è¯†åˆ«æ–‡å­—å’Œå›¾å½¢ <a class="header-anchor" href="#ä¸ƒã€å›¾æ–‡åˆ†å±‚-è‡ªåŠ¨è¯†åˆ«æ–‡å­—å’Œå›¾å½¢" aria-label="Permalink to &quot;ä¸ƒã€å›¾æ–‡åˆ†å±‚ï¼šè‡ªåŠ¨è¯†åˆ«æ–‡å­—å’Œå›¾å½¢&quot;">â€‹</a></h2><h3 id="_7-1-åŠŸèƒ½æè¿°" tabindex="-1">7.1 åŠŸèƒ½æè¿° <a class="header-anchor" href="#_7-1-åŠŸèƒ½æè¿°" aria-label="Permalink to &quot;7.1 åŠŸèƒ½æè¿°&quot;">â€‹</a></h3><p><strong>è¾“å…¥</strong>ï¼šè®¾è®¡æµ·æŠ¥å›¾ç‰‡<br><strong>è¾“å‡º</strong>ï¼šå¯ç¼–è¾‘çš„æ¨¡æ¿ï¼ˆæ–‡å­—å±‚ + å›¾å½¢å±‚ + èƒŒæ™¯å±‚ï¼‰</p><p><strong>å…¸å‹åœºæ™¯</strong>ï¼š</p><ul><li>å°†è®¾è®¡å¥½çš„æµ·æŠ¥è½¬æˆå¯ç¼–è¾‘æ¨¡æ¿</li><li>æå–å›¾ç‰‡ä¸­çš„æ–‡å­—å†…å®¹</li><li>åˆ†ç¦»å›¾ç‰‡ä¸­çš„å›¾å½¢å…ƒç´ </li></ul><h3 id="_7-2-å®ç°æµç¨‹" tabindex="-1">7.2 å®ç°æµç¨‹ <a class="header-anchor" href="#_7-2-å®ç°æµç¨‹" aria-label="Permalink to &quot;7.2 å®ç°æµç¨‹&quot;">â€‹</a></h3><div class="language- vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>ç”¨æˆ·æ“ä½œæµç¨‹ï¼š</span></span>
<span class="line"><span>1. é€‰ä¸­æµ·æŠ¥å›¾ç‰‡</span></span>
<span class="line"><span>2. ç‚¹å‡»&quot;å›¾æ–‡åˆ†å±‚&quot;</span></span>
<span class="line"><span>3. ç³»ç»Ÿè‡ªåŠ¨è¯†åˆ«ï¼š</span></span>
<span class="line"><span>   - æ–‡å­—å†…å®¹ã€ä½ç½®ã€å­—ä½“ã€é¢œè‰²</span></span>
<span class="line"><span>   - å›¾å½¢å…ƒç´ ã€è·¯å¾„ã€å¡«å……</span></span>
<span class="line"><span>   - èƒŒæ™¯å›¾å±‚</span></span>
<span class="line"><span>4. ç”Ÿæˆå¯ç¼–è¾‘çš„æ¨¡æ¿</span></span>
<span class="line"><span>5. ç”¨æˆ·å¯ä»¥ä¿®æ”¹æ–‡å­—ã€æ›¿æ¢å›¾å½¢</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><h3 id="_7-3-å…³é”®æŠ€æœ¯" tabindex="-1">7.3 å…³é”®æŠ€æœ¯ <a class="header-anchor" href="#_7-3-å…³é”®æŠ€æœ¯" aria-label="Permalink to &quot;7.3 å…³é”®æŠ€æœ¯&quot;">â€‹</a></h3><p><strong>æ ¸å¿ƒAPIè°ƒç”¨</strong>ï¼š</p><div class="language-typescript vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">typescript</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> result</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> await</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> fetch</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;/api/ai/image-to-template&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  method: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;POST&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  body: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">JSON</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">stringify</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">({</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    image_url: element.imageUrl,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    detect_text: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">true</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,       </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// è¯†åˆ«æ–‡å­—</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    detect_graphics: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">true</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,   </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// è¯†åˆ«å›¾å½¢</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  }),</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">});</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// è¿”å›ç»“æœ</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">{</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">  &quot;background_layer&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;https://cdn.com/background.jpg&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">  &quot;text_layers&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: [</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    {</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">      &quot;content&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;æ˜¥å­£æ–°å“&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">      &quot;font_family&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;PingFang SC&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">      &quot;font_size&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">48</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">      &quot;color&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;#ff0000&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">      &quot;position&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: { </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;x&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">100</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;y&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">200</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> },</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    },</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    // ... æ›´å¤šæ–‡å­—å±‚</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  ],</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">  &quot;graphic_layers&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: [</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    {</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">      &quot;type&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;shape&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">      &quot;path_data&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;M 0,0 L 100,0 L 100,100 Z&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">      &quot;fill_color&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;#0000ff&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">      &quot;position&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: { </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;x&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">50</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;y&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">50</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> },</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    },</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    // ... æ›´å¤šå›¾å½¢å±‚</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  ],</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br></div></div><p><strong>å‰ç«¯å¤„ç†</strong>ï¼š</p><div class="language-typescript vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">typescript</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// åˆ›å»ºæ¨¡æ¿ç»“æ„</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">function</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> createTemplateFromLayers</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">result</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> template</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    background: result.background_layer,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    elements: [],</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  };</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">  // æ·»åŠ æ–‡å­—å±‚</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  result.text_layers.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">forEach</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">((</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">textLayer</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> textElement</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> editor.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">createElement</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">({</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      type: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;text&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      content: textLayer.content,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      fontFamily: textLayer.font_family,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      fontSize: textLayer.font_size,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      color: textLayer.color,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      transform: textLayer.position,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    });</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    template.elements.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">push</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(textElement);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  });</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">  // æ·»åŠ å›¾å½¢å±‚</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  result.graphic_layers.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">forEach</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">((</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">graphicLayer</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> shapeElement</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> editor.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">createElement</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">({</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      type: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;shape&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      pathData: graphicLayer.path_data,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      fill: graphicLayer.fill_color,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      transform: graphicLayer.position,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    });</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    template.elements.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">push</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(shapeElement);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  });</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  return</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> template;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// æ›¿æ¢åŸå…ƒç´ ä¸ºæ¨¡æ¿ç»„</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">function</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> replaceWithTemplate</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">element</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">template</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">  // åˆ é™¤åŸå›¾ç‰‡å…ƒç´ </span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  editor.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">removeElement</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(element);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">  // æ·»åŠ æ¨¡æ¿å…ƒç´ </span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  template.elements.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">forEach</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">((</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">el</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    editor.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">addElement</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(el);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  });</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br></div></div><hr><h2 id="å…«ã€è½¬çŸ¢é‡-ä½å›¾è½¬çŸ¢é‡" tabindex="-1">å…«ã€è½¬çŸ¢é‡ï¼šä½å›¾è½¬çŸ¢é‡ <a class="header-anchor" href="#å…«ã€è½¬çŸ¢é‡-ä½å›¾è½¬çŸ¢é‡" aria-label="Permalink to &quot;å…«ã€è½¬çŸ¢é‡ï¼šä½å›¾è½¬çŸ¢é‡&quot;">â€‹</a></h2><h3 id="_8-1-åŠŸèƒ½æè¿°" tabindex="-1">8.1 åŠŸèƒ½æè¿° <a class="header-anchor" href="#_8-1-åŠŸèƒ½æè¿°" aria-label="Permalink to &quot;8.1 åŠŸèƒ½æè¿°&quot;">â€‹</a></h3><p><strong>è¾“å…¥</strong>ï¼šä½å›¾ï¼ˆPNG/JPGï¼‰<br><strong>è¾“å‡º</strong>ï¼šçŸ¢é‡å›¾ï¼ˆSVGï¼‰</p><p><strong>å…¸å‹åœºæ™¯</strong>ï¼š</p><ul><li>Logoè½¬çŸ¢é‡ï¼Œæ— æŸç¼©æ”¾</li><li>å›¾æ ‡è½¬SVGæ ¼å¼</li><li>ç®€ç¬”ç”»è½¬å¯ç¼–è¾‘çŸ¢é‡</li></ul><h3 id="_8-2-å…³é”®æŠ€æœ¯" tabindex="-1">8.2 å…³é”®æŠ€æœ¯ <a class="header-anchor" href="#_8-2-å…³é”®æŠ€æœ¯" aria-label="Permalink to &quot;8.2 å…³é”®æŠ€æœ¯&quot;">â€‹</a></h3><p><strong>æ ¸å¿ƒAPIè°ƒç”¨</strong>ï¼š</p><div class="language-typescript vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">typescript</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> result</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> await</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> fetch</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;/api/ai/image-to-svg&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  method: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;POST&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  body: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">JSON</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">stringify</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">({</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    image_url: element.imageUrl,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    simplify: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">true</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,      </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// ç®€åŒ–è·¯å¾„</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    color_mode: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;auto&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,  </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// &#39;auto&#39;|&#39;mono&#39;|&#39;color&#39;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  }),</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">});</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// è¿”å›ç»“æœ</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">{</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">  &quot;svg_data&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;&lt;svg&gt;...&lt;/svg&gt;&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">  &quot;svg_url&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;https://cdn.com/vector.svg&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br></div></div><p><strong>å‰ç«¯å¤„ç†</strong>ï¼š</p><div class="language-typescript vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">typescript</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// åˆ›å»ºSVGå…ƒç´ æ›¿æ¢åŸå›¾ç‰‡</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> svgElement</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> editor.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">createElement</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">({</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  type: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;svg&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  svgData: result.svg_data,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  svgUrl: result.svg_url,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  transform: element.transform,  </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// ç»§æ‰¿åŸä½ç½®</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">});</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">editor.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">replaceElement</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(element, svgElement);</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><hr><h2 id="ä¹ã€aiæ»¤é•œ-å›¾ç‰‡é£æ ¼è½¬æ¢" tabindex="-1">ä¹ã€AIæ»¤é•œï¼šå›¾ç‰‡é£æ ¼è½¬æ¢ <a class="header-anchor" href="#ä¹ã€aiæ»¤é•œ-å›¾ç‰‡é£æ ¼è½¬æ¢" aria-label="Permalink to &quot;ä¹ã€AIæ»¤é•œï¼šå›¾ç‰‡é£æ ¼è½¬æ¢&quot;">â€‹</a></h2><h3 id="_9-1-åŠŸèƒ½æè¿°" tabindex="-1">9.1 åŠŸèƒ½æè¿° <a class="header-anchor" href="#_9-1-åŠŸèƒ½æè¿°" aria-label="Permalink to &quot;9.1 åŠŸèƒ½æè¿°&quot;">â€‹</a></h3><p><strong>è¾“å…¥</strong>ï¼šå›¾ç‰‡ + ç›®æ ‡é£æ ¼<br><strong>è¾“å‡º</strong>ï¼šé£æ ¼åŒ–åçš„å›¾ç‰‡</p><p><strong>å…¸å‹åœºæ™¯</strong>ï¼š</p><ul><li>ç…§ç‰‡è½¬æ²¹ç”»</li><li>ç…§ç‰‡è½¬ç´ æ</li><li>ç…§ç‰‡è½¬åŠ¨æ¼«é£æ ¼</li></ul><h3 id="_9-2-å…³é”®æŠ€æœ¯" tabindex="-1">9.2 å…³é”®æŠ€æœ¯ <a class="header-anchor" href="#_9-2-å…³é”®æŠ€æœ¯" aria-label="Permalink to &quot;9.2 å…³é”®æŠ€æœ¯&quot;">â€‹</a></h3><p><strong>æ ¸å¿ƒAPIè°ƒç”¨</strong>ï¼š</p><div class="language-typescript vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">typescript</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> result</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> await</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> fetch</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;/api/ai/style-transfer&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  method: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;POST&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  body: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">JSON</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">stringify</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">({</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    image_url: element.imageUrl,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    style: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;oil_painting&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,  </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// é£æ ¼ï¼š&#39;oil_painting&#39;|&#39;sketch&#39;|&#39;anime&#39;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    strength: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0.8</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,          </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// é£æ ¼å¼ºåº¦ï¼ˆ0-1ï¼‰</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  }),</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">});</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><hr><h2 id="åã€å·¥å…·é€šç”¨å¤„ç†æµç¨‹" tabindex="-1">åã€å·¥å…·é€šç”¨å¤„ç†æµç¨‹ <a class="header-anchor" href="#åã€å·¥å…·é€šç”¨å¤„ç†æµç¨‹" aria-label="Permalink to &quot;åã€å·¥å…·é€šç”¨å¤„ç†æµç¨‹&quot;">â€‹</a></h2><h3 id="_10-1-ç»Ÿä¸€çš„å‰ç«¯æ¶æ„" tabindex="-1">10.1 ç»Ÿä¸€çš„å‰ç«¯æ¶æ„ <a class="header-anchor" href="#_10-1-ç»Ÿä¸€çš„å‰ç«¯æ¶æ„" aria-label="Permalink to &quot;10.1 ç»Ÿä¸€çš„å‰ç«¯æ¶æ„&quot;">â€‹</a></h3><p>æ‰€æœ‰AIå·¥å…·éƒ½éµå¾ªç›¸åŒçš„å¤„ç†æµç¨‹ï¼š</p><div class="language-typescript vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">typescript</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// ç»Ÿä¸€çš„å·¥å…·è°ƒç”¨æµç¨‹</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">async</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> function</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> executeAITool</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">toolType</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> string</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">params</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> any</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">  // 1. å‚æ•°éªŒè¯</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">  validateParams</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(params);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">  // 2. æ˜¾ç¤ºåŠ è½½çŠ¶æ€</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">  showLoading</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">();</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">  // 3. è°ƒç”¨API</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> result</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> await</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> callAIToolAPI</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(toolType, params);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">  // 4. ä¿å­˜è®°å½•</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  await</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> saveToolRecord</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">({</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    tool_type: toolType,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    params,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    result,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    element_id: params.element_id,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  });</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">  // 5. æ›´æ–°ç”»å¸ƒ</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">  updateCanvasElement</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(result);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">  // 6. éšè—åŠ è½½çŠ¶æ€</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">  hideLoading</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">();</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">  // 7. åŸ‹ç‚¹è¿½è¸ª</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  tracker.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">trackToolCompleted</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">({</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    tool_name: toolType,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    elapsed_time: Date.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">now</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">() </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> startTime,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  });</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br></div></div><h3 id="_10-2-é”™è¯¯å¤„ç†" tabindex="-1">10.2 é”™è¯¯å¤„ç† <a class="header-anchor" href="#_10-2-é”™è¯¯å¤„ç†" aria-label="Permalink to &quot;10.2 é”™è¯¯å¤„ç†&quot;">â€‹</a></h3><div class="language-typescript vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">typescript</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">try</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  await</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> executeAITool</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(toolType, params);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">} </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">catch</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (error) {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (error.code </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">===</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;INSUFFICIENT_BALANCE&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) {</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">    showToast</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;ç¨¿è±†ä¸è¶³ï¼Œè¯·å……å€¼&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">    openPaymentModal</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">();</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  } </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">else</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (error.code </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">===</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;IMAGE_TOO_LARGE&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) {</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">    showToast</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;å›¾ç‰‡å¤ªå¤§ï¼Œè¯·å…ˆå‹ç¼©&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  } </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">else</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">    showToast</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;å¤„ç†å¤±è´¥ï¼Œè¯·é‡è¯•&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  }</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">  // é”™è¯¯åŸ‹ç‚¹</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  tracker.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">trackToolFailed</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">({</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    tool_name: toolType,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    error_code: error.code,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    error_message: error.message,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  });</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br></div></div><h3 id="_10-3-ç¼“å­˜ç­–ç•¥" tabindex="-1">10.3 ç¼“å­˜ç­–ç•¥ <a class="header-anchor" href="#_10-3-ç¼“å­˜ç­–ç•¥" aria-label="Permalink to &quot;10.3 ç¼“å­˜ç­–ç•¥&quot;">â€‹</a></h3><div class="language-typescript vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">typescript</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// å·¥å…·ç»“æœç¼“å­˜</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">class</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> ToolResultCache</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  private</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> cache</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> new</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> Map</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&lt;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">string</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Promise</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&lt;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">any</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;&gt;();</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  async</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> getOrFetch</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">key</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> string</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">fetcher</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">:</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> () </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=&gt;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> Promise</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&lt;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">any</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;) {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    // æ£€æŸ¥ç¼“å­˜</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">this</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.cache.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">has</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(key)) {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">      return</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> this</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.cache.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">get</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(key);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    }</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    // å‘èµ·è¯·æ±‚</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> promise</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> fetcher</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">();</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    this</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.cache.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">set</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(key, promise);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    // è¯·æ±‚å¤±è´¥æ—¶åˆ é™¤ç¼“å­˜</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    promise.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">catch</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(() </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">      this</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.cache.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">delete</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(key);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    });</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    return</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> promise;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  }</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">  clear</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">() {</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    this</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.cache.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">clear</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">();</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// ä½¿ç”¨ç¤ºä¾‹</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> cacheKey</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> \`\${</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">toolType</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">}_\${</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">imageUrl</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">}\`</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> result</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> await</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> toolResultCache.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">getOrFetch</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(cacheKey, () </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  return</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> callAIToolAPI</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(toolType, params);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">});</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br></div></div><hr><h2 id="åä¸€ã€æ€»ç»“ä¸æœ€ä½³å®è·µ" tabindex="-1">åä¸€ã€æ€»ç»“ä¸æœ€ä½³å®è·µ <a class="header-anchor" href="#åä¸€ã€æ€»ç»“ä¸æœ€ä½³å®è·µ" aria-label="Permalink to &quot;åä¸€ã€æ€»ç»“ä¸æœ€ä½³å®è·µ&quot;">â€‹</a></h2><h3 id="_11-1-è®¾è®¡åŸåˆ™" tabindex="-1">11.1 è®¾è®¡åŸåˆ™ <a class="header-anchor" href="#_11-1-è®¾è®¡åŸåˆ™" aria-label="Permalink to &quot;11.1 è®¾è®¡åŸåˆ™&quot;">â€‹</a></h3><ol><li><strong>ç»Ÿä¸€çš„ç”¨æˆ·ä½“éªŒ</strong>ï¼šæ‰€æœ‰å·¥å…·éƒ½éµå¾ªç›¸åŒçš„äº¤äº’æµç¨‹</li><li><strong>å³æ—¶åé¦ˆ</strong>ï¼šåŠ è½½çŠ¶æ€ã€è¿›åº¦æç¤ºã€ç»“æœé¢„è§ˆ</li><li><strong>å®¹é”™æœºåˆ¶</strong>ï¼šç½‘ç»œå¼‚å¸¸ã€APIå¤±è´¥ã€å‚æ•°é”™è¯¯éƒ½æœ‰å‹å¥½æç¤º</li><li><strong>è®°å½•å¯è¿½æº¯</strong>ï¼šæ¯æ¬¡æ“ä½œéƒ½ä¿å­˜è®°å½•ï¼Œæ”¯æŒæ’¤é”€å’Œé‡åš</li></ol><h3 id="_11-2-æ€§èƒ½ä¼˜åŒ–" tabindex="-1">11.2 æ€§èƒ½ä¼˜åŒ– <a class="header-anchor" href="#_11-2-æ€§èƒ½ä¼˜åŒ–" aria-label="Permalink to &quot;11.2 æ€§èƒ½ä¼˜åŒ–&quot;">â€‹</a></h3><ol><li><strong>æ‡’åŠ è½½</strong>ï¼šå·¥å…·é¢æ¿æŒ‰éœ€åŠ è½½</li><li><strong>ç»“æœç¼“å­˜</strong>ï¼šç›¸åŒå‚æ•°çš„è¯·æ±‚å¤ç”¨ç»“æœ</li><li><strong>å¹¶è¡Œå¤„ç†</strong>ï¼šæ‰¹é‡å·¥å…·å¯ä»¥å¹¶è¡Œæ‰§è¡Œ</li><li><strong>æ™ºèƒ½é¢„åŠ è½½</strong>ï¼šé¢„æµ‹ç”¨æˆ·å¯èƒ½ä½¿ç”¨çš„å·¥å…·ï¼Œæå‰åŠ è½½èµ„æº</li></ol><h3 id="_11-3-ä¸‹ä¸€æ­¥" tabindex="-1">11.3 ä¸‹ä¸€æ­¥ <a class="header-anchor" href="#_11-3-ä¸‹ä¸€æ­¥" aria-label="Permalink to &quot;11.3 ä¸‹ä¸€æ­¥&quot;">â€‹</a></h3><ul><li><strong>ä¸Šä¸€ç¯‡</strong>ï¼š<a href="./07-Agentå·¥ä½œæµç¨‹">07-Agentå·¥ä½œæµç¨‹</a> - äº†è§£Agentç¼–æ’</li><li><strong>ä¸‹ä¸€ç¯‡</strong>ï¼š<a href="./08-æ€§èƒ½ä¼˜åŒ–ä¸é”™è¯¯å¤„ç†">08-æ€§èƒ½ä¼˜åŒ–ä¸é”™è¯¯å¤„ç†</a> - å­¦ä¹ ç³»ç»Ÿä¼˜åŒ–</li></ul><hr><blockquote><p><strong>æœ¬ç« å®Œæˆï¼</strong> æ‚¨å·²ç»æŒæ¡äº†æ‰€æœ‰AIå·¥å…·çš„å‰ç«¯å®ç°åŸç†ã€‚</p></blockquote>`,132)]))}const g=a(p,[["render",e]]);export{c as __pageData,g as default};
