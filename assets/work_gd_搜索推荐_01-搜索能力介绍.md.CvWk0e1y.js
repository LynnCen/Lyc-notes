import{_ as a,c as n,o as i,a7 as p}from"./chunks/framework.BQb8NfN9.js";const l="/Lyc-notes/assets/%E8%8A%B1%E7%93%A3%E6%90%9C%E7%B4%A2%E7%AD%96%E7%95%A5%E6%A1%86%E6%9E%B6.Cd8UUZ4F.png",e="/Lyc-notes/assets/image2023-3-8_13-13-33.BTbJ37u_.png",t="/Lyc-notes/assets/image2023-3-8_12-34-20.BHf-9Bo_.png",r="/Lyc-notes/assets/image2023-3-8_11-12-55.BFwmBW92.png",h="/Lyc-notes/assets/image2023-3-8_12-33-40.DYtBrp1E.png",k="/Lyc-notes/assets/image2023-3-8_14-0-52.CmvshPNA.png",d="/Lyc-notes/assets/image2023-3-8_14-1-33.B6OVogLs.png",c="/Lyc-notes/assets/image2023-3-9_14-15-18.Bfg15yvx.png",E="/Lyc-notes/assets/image2023-3-8_11-22-38.3JTqLxKu.png",b="/Lyc-notes/assets/image2023-3-8_13-58-47.DEBcCQ6u.png",_=JSON.parse('{"title":"花瓣搜索能力介绍","description":"","frontmatter":{},"headers":[],"relativePath":"work/gd/搜索推荐/01-搜索能力介绍.md","filePath":"work/gd/搜索推荐/01-搜索能力介绍.md","lastUpdated":1770085732000}'),g={name:"work/gd/搜索推荐/01-搜索能力介绍.md"};function u(o,s,m,y,F,v){return i(),n("div",null,s[0]||(s[0]=[p(`<h1 id="花瓣搜索能力介绍" tabindex="-1">花瓣搜索能力介绍 <a class="header-anchor" href="#花瓣搜索能力介绍" aria-label="Permalink to &quot;花瓣搜索能力介绍&quot;">​</a></h1><blockquote><p><strong>文档来源</strong><br> Confluence: <a href="https://doc.huanleguang.com/pages/viewpage.action?pageId=286485554" target="_blank" rel="noreferrer">https://doc.huanleguang.com/pages/viewpage.action?pageId=286485554</a></p></blockquote><hr><h2 id="文档更新记录" tabindex="-1">文档更新记录 <a class="header-anchor" href="#文档更新记录" aria-label="Permalink to &quot;文档更新记录&quot;">​</a></h2><table tabindex="0"><thead><tr><th>版本</th><th>操作</th><th>修订内容</th><th>修订日期</th><th>修订人</th></tr></thead><tbody><tr><td>1.0</td><td>新增</td><td>花瓣搜索能力介绍初版</td><td>2023-03-08</td><td>@未知用户 (haikui)</td></tr><tr><td>2.0</td><td>优化</td><td>文档结构化整理和美化</td><td>2025-01-25</td><td>文档整理团队</td></tr></tbody></table><hr><h2 id="文档概述" tabindex="-1">文档概述 <a class="header-anchor" href="#文档概述" aria-label="Permalink to &quot;文档概述&quot;">​</a></h2><p>本文档详细介绍<strong>花瓣网搜索能力</strong>的完整架构、算法策略和技术实现，涵盖搜索理解、召回、排序等核心环节。</p><p><strong>核心价值</strong>：</p><ul><li>📊 搜索是花瓣网核心功能，近 <strong>60%</strong> 访客使用搜索</li><li>🚀 搜索结果页是花瓣网 <strong>第二大流量页面</strong></li><li>🎯 完整的搜索三阶段架构</li></ul><hr><h2 id="一、引言" tabindex="-1">一、引言 <a class="header-anchor" href="#一、引言" aria-label="Permalink to &quot;一、引言&quot;">​</a></h2><h3 id="_1-1-搜索的重要性" tabindex="-1">1.1 搜索的重要性 <a class="header-anchor" href="#_1-1-搜索的重要性" aria-label="Permalink to &quot;1.1 搜索的重要性&quot;">​</a></h3><p><strong>数据说明搜索的价值</strong>：</p><div class="language- vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>访客使用率：近 60% 的花瓣访客使用搜索功能</span></span>
<span class="line"><span>页面流量：搜索结果页为花瓣第二大访客量页面</span></span>
<span class="line"><span>业务影响：搜索质量直接影响用户留存和转化</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><h3 id="_1-2-什么是搜索" tabindex="-1">1.2 什么是搜索 <a class="header-anchor" href="#_1-2-什么是搜索" aria-label="Permalink to &quot;1.2 什么是搜索&quot;">​</a></h3><p><strong>搜索的本质</strong>：</p><blockquote><p>搜索是用户的搜索词（Query）与系统海量内容完成匹配的过程</p></blockquote><p><strong>经典三阶段架构</strong>：</p><div class="language- vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>┌─────────────────────────────────────────────┐</span></span>
<span class="line"><span>│   阶段 1：搜索理解与处理                     │</span></span>
<span class="line"><span>│                                             │</span></span>
<span class="line"><span>│   • 词法分析：分词                           │</span></span>
<span class="line"><span>│   • 句法分析：语法结构                       │</span></span>
<span class="line"><span>│   • 语义理解：同义词、近义词                 │</span></span>
<span class="line"><span>│                                             │</span></span>
<span class="line"><span>│   目的：理解用户意图，处理歧义和不准确表达   │</span></span>
<span class="line"><span>└──────────────────┬──────────────────────────┘</span></span>
<span class="line"><span>                   │</span></span>
<span class="line"><span>                   ▼</span></span>
<span class="line"><span>┌─────────────────────────────────────────────┐</span></span>
<span class="line"><span>│   阶段 2：检索召回                          │</span></span>
<span class="line"><span>│                                             │</span></span>
<span class="line"><span>│   • 内容理解：标签、标题、描述               │</span></span>
<span class="line"><span>│   • 相关性匹配：Query 与内容匹配            │</span></span>
<span class="line"><span>│   • 召回策略：文本、向量、业务池             │</span></span>
<span class="line"><span>│                                             │</span></span>
<span class="line"><span>│   目的：从海量数据中筛选出相关内容           │</span></span>
<span class="line"><span>└──────────────────┬──────────────────────────┘</span></span>
<span class="line"><span>                   │</span></span>
<span class="line"><span>                   ▼</span></span>
<span class="line"><span>┌─────────────────────────────────────────────┐</span></span>
<span class="line"><span>│   阶段 3：排序                              │</span></span>
<span class="line"><span>│                                             │</span></span>
<span class="line"><span>│   • 粗排：初步排序                           │</span></span>
<span class="line"><span>│   • 精排：精细化排序                         │</span></span>
<span class="line"><span>│   • 重排：业务策略调整                       │</span></span>
<span class="line"><span>│                                             │</span></span>
<span class="line"><span>│   目的：预测用户需求，呈现最优结果           │</span></span>
<span class="line"><span>└─────────────────────────────────────────────┘</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br></div></div><p><strong>花瓣搜索架构</strong>围绕该流程进行建设。</p><hr><h2 id="二、搜索能力框架" tabindex="-1">二、搜索能力框架 <a class="header-anchor" href="#二、搜索能力框架" aria-label="Permalink to &quot;二、搜索能力框架&quot;">​</a></h2><h3 id="_2-1-整体架构" tabindex="-1">2.1 整体架构 <a class="header-anchor" href="#_2-1-整体架构" aria-label="Permalink to &quot;2.1 整体架构&quot;">​</a></h3><p><img src="`+l+`" alt="花瓣搜索策略框架"></p><p><strong>架构层次</strong>：</p><div class="language- vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>┌──────────────────────────────────────────────┐</span></span>
<span class="line"><span>│          用户交互层                           │</span></span>
<span class="line"><span>│  • 搜索框                                    │</span></span>
<span class="line"><span>│  • 热词推荐                                  │</span></span>
<span class="line"><span>│  • 联想词                                    │</span></span>
<span class="line"><span>│  • 历史搜索                                  │</span></span>
<span class="line"><span>└──────────────────┬───────────────────────────┘</span></span>
<span class="line"><span>                   │</span></span>
<span class="line"><span>┌──────────────────┴───────────────────────────┐</span></span>
<span class="line"><span>│          搜索理解层                           │</span></span>
<span class="line"><span>│  • 分词（Jieba）                             │</span></span>
<span class="line"><span>│  • 同义词映射                                │</span></span>
<span class="line"><span>│  • Query 改写                                │</span></span>
<span class="line"><span>└──────────────────┬───────────────────────────┘</span></span>
<span class="line"><span>                   │</span></span>
<span class="line"><span>┌──────────────────┴───────────────────────────┐</span></span>
<span class="line"><span>│          召回层                              │</span></span>
<span class="line"><span>│  • 文本召回 + LR 排序                        │</span></span>
<span class="line"><span>│  • 多目标个性化召回                          │</span></span>
<span class="line"><span>│  • 业务池召回                                │</span></span>
<span class="line"><span>└──────────────────┬───────────────────────────┘</span></span>
<span class="line"><span>                   │</span></span>
<span class="line"><span>┌──────────────────┴───────────────────────────┐</span></span>
<span class="line"><span>│          排序层                              │</span></span>
<span class="line"><span>│  • 粗排（LR）                                │</span></span>
<span class="line"><span>│  • 精排（多目标 CTR 预估）                   │</span></span>
<span class="line"><span>│  • 重排（L4分、扶持分）                      │</span></span>
<span class="line"><span>└──────────────────┬───────────────────────────┘</span></span>
<span class="line"><span>                   │</span></span>
<span class="line"><span>┌──────────────────┴───────────────────────────┐</span></span>
<span class="line"><span>│          策略层                              │</span></span>
<span class="line"><span>│  • 比例混排                                  │</span></span>
<span class="line"><span>│  • 扶持分重排                                │</span></span>
<span class="line"><span>│  • 素材/灵感比例调整                         │</span></span>
<span class="line"><span>└──────────────────────────────────────────────┘</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br></div></div><h3 id="_2-2-搜索类型" tabindex="-1">2.2 搜索类型 <a class="header-anchor" href="#_2-2-搜索类型" aria-label="Permalink to &quot;2.2 搜索类型&quot;">​</a></h3><p>花瓣搜索支持多种搜索类型：</p><table tabindex="0"><thead><tr><th>搜索类型</th><th>说明</th><th>特点</th></tr></thead><tbody><tr><td><strong>采集搜索</strong></td><td>搜索灵感内容（采集）</td><td>个性化推荐为主</td></tr><tr><td><strong>素材搜索</strong></td><td>搜索设计素材</td><td>精准匹配为主</td></tr><tr><td><strong>模板搜索</strong></td><td>搜索设计模板</td><td>复用稿定模板搜索接口</td></tr></tbody></table><hr><h2 id="三、采集搜索-素材搜索" tabindex="-1">三、采集搜索 &amp; 素材搜索 <a class="header-anchor" href="#三、采集搜索-素材搜索" aria-label="Permalink to &quot;三、采集搜索 &amp; 素材搜索&quot;">​</a></h2><h3 id="_3-1-搜索能力详解" tabindex="-1">3.1 搜索能力详解 <a class="header-anchor" href="#_3-1-搜索能力详解" aria-label="Permalink to &quot;3.1 搜索能力详解&quot;">​</a></h3><h4 id="_3-1-1-搜索前-引导用户搜索" tabindex="-1">3.1.1 搜索前 - 引导用户搜索 <a class="header-anchor" href="#_3-1-1-搜索前-引导用户搜索" aria-label="Permalink to &quot;3.1.1 搜索前 - 引导用户搜索&quot;">​</a></h4><p><strong>目标</strong>：降低用户决策成本，提升搜索效率</p><h5 id="a-搜索热词" tabindex="-1">A. 搜索热词 <a class="header-anchor" href="#a-搜索热词" aria-label="Permalink to &quot;A. 搜索热词&quot;">​</a></h5><p><strong>定义</strong>：基于搜索热度推荐的高频搜索词</p><p><img src="`+e+`" alt="搜索热词示例"></p><p><strong>策略详情</strong>：</p><div class="language-yaml vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">yaml</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">统计规则</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">  数据源</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">搜索日志</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">  统计周期</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">近 12 小时</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">  统计指标</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">搜索 UV（去重）</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">  数据处理</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    - </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">英文统一转大写</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    - </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">取 TOP 10</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    </span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">去重规则</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">  同义词过滤</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    - </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">互相包含的词</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    - </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">字符串重叠占比过高</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    </span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">降权规则</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">  条件</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">本次统计的热词与上次重复</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">  操作</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">对该热词进行降权</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  </span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">更新策略</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">  统计周期</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">12 小时</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">  更新频率</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">每小时更新一次</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br></div></div><p><strong>实现逻辑</strong>：</p><div class="language-python vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 伪代码</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">def</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> get_search_hot_words</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">():</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    # 1. 统计近 12h 搜索 UV</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    logs </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> fetch_search_logs(</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">hours</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">12</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    word_uv </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> count_unique_visitors(logs)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    </span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    # 2. 数据处理</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    word_uv </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> normalize_words(word_uv)  </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 英文大写</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    </span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    # 3. 去重</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    word_uv </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> filter_synonyms(word_uv)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    </span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    # 4. 降权处理</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    previous_hot_words </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> get_previous_hot_words()</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    word_uv </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> apply_decay(word_uv, previous_hot_words)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    </span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    # 5. 取 TOP 10</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    hot_words </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> get_top_n(word_uv, </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">n</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">10</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    </span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    return</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> hot_words</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br></div></div><h5 id="b-历史搜索词" tabindex="-1">B. 历史搜索词 <a class="header-anchor" href="#b-历史搜索词" aria-label="Permalink to &quot;B. 历史搜索词&quot;">​</a></h5><p><strong>定义</strong>：用户历史搜索过的搜索词</p><p><img src="`+t+`" alt="历史搜索词示例"></p><p><strong>策略详情</strong>：</p><div class="language-yaml vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">yaml</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">数据来源</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  - </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">用户本地存储（LocalStorage/Cookie）</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  </span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">展示规则</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  - </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">界面默认展示一行历史记录</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  - </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">按时间倒序排列</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  </span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">处理方</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  - </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">花瓣前端处理</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><h5 id="c-搜索底纹词" tabindex="-1">C. 搜索底纹词 <a class="header-anchor" href="#c-搜索底纹词" aria-label="Permalink to &quot;C. 搜索底纹词&quot;">​</a></h5><p><strong>状态</strong>：暂无</p><hr><h4 id="_3-1-2-搜索中-辅助用户输入" tabindex="-1">3.1.2 搜索中 - 辅助用户输入 <a class="header-anchor" href="#_3-1-2-搜索中-辅助用户输入" aria-label="Permalink to &quot;3.1.2 搜索中 - 辅助用户输入&quot;">​</a></h4><p><strong>目标</strong>：减少输入成本，纠正输入错误</p><h5 id="a-搜索联想词" tabindex="-1">A. 搜索联想词 <a class="header-anchor" href="#a-搜索联想词" aria-label="Permalink to &quot;A. 搜索联想词&quot;">​</a></h5><p><strong>定义</strong>：对用户输入的 Query 进行联想扩展</p><p><img src="`+r+`" alt="搜索联想词示例"></p><p><strong>策略详情</strong>：</p><div class="language-yaml vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">yaml</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">实现方式</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  - </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">记录用户搜索词</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  - </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">在搜索词表中进行前缀匹配</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  </span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">排序规则</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  - </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">根据最近搜索次数排序</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  - </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">搜索次数越高，排序越靠前</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  </span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">当前状态</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  - </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">目前由花瓣后端处理</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  - </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">后续计划交接到搜索侧</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  - </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">需要维护搜索联想词表</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br></div></div><p><strong>工作原理</strong>：</p><div class="language-python vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 伪代码</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">def</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> get_suggest_words</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(prefix):</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    # 1. 从联想词表中查找</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    candidates </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> search_suggest_table</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        .filter(word.startswith(prefix))</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        .order_by(search_count </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">DESC</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        .limit(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">10</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    </span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    # 2. 返回联想词</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    return</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> candidates</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><hr><h4 id="_3-1-3-搜索后-引导精准搜索" tabindex="-1">3.1.3 搜索后 - 引导精准搜索 <a class="header-anchor" href="#_3-1-3-搜索后-引导精准搜索" aria-label="Permalink to &quot;3.1.3 搜索后 - 引导精准搜索&quot;">​</a></h4><p><strong>目标</strong>：当无结果时引导用户重新搜索</p><h5 id="a-搜索推荐词" tabindex="-1">A. 搜索推荐词 <a class="header-anchor" href="#a-搜索推荐词" aria-label="Permalink to &quot;A. 搜索推荐词&quot;">​</a></h5><p><strong>定义</strong>：无搜索结果时推荐的相关搜索词</p><p><img src="`+h+`" alt="搜索推荐词示例"></p><p><strong>策略详情</strong>：</p><div class="language-yaml vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">yaml</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">过滤规则</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">  数据范围</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">近 90 天</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">  条件</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    - </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">搜索 UV &gt; 5</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    - </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">搜索结果点击 &gt; 1</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">  黑名单</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">过滤搜索敏感词</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  </span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">统计规则</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">  方法</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">分词后统计词语共现频率</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">  原理</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">经常同时出现的词，组合成词的可能性更大</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  </span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">排序规则</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  - </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">按搜索次数倒序排列</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br></div></div><p><strong>实现示例</strong>：</p><div class="language-python vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 伪代码</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">def</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> get_recommend_words</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(query):</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    # 1. 对 query 分词</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    terms </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> jieba.cut(query)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    </span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    # 2. 查找共现词</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    co_occur_words </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> []</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    for</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> term </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">in</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> terms:</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        words </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> get_co_occurrence_words(term)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        co_occur_words.extend(words)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    </span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    # 3. 过滤</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    valid_words </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> filter_words(co_occur_words, </span></span>
<span class="line"><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">                                min_uv</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">5</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span></span>
<span class="line"><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">                                min_click</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    </span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    # 4. 排序</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    recommend_words </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> sort_by_search_count(valid_words)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    </span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    return</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> recommend_words[:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">10</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br></div></div><hr><h3 id="_3-2-搜索理解" tabindex="-1">3.2 搜索理解 <a class="header-anchor" href="#_3-2-搜索理解" aria-label="Permalink to &quot;3.2 搜索理解&quot;">​</a></h3><p><strong>目标</strong>：理解用户搜索意图，进行结构化解析</p><h4 id="_3-2-1-分词" tabindex="-1">3.2.1 分词 <a class="header-anchor" href="#_3-2-1-分词" aria-label="Permalink to &quot;3.2.1 分词&quot;">​</a></h4><p><strong>定义</strong>：将 Query 切分成多个 Term</p><p><img src="`+k+`" alt="分词示例"></p><p><strong>示例</strong>：</p><div class="language- vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>输入: &quot;手机海报&quot;</span></span>
<span class="line"><span>↓ 分词</span></span>
<span class="line"><span>输出: [&quot;手机&quot;, &quot;海报&quot;]</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p><strong>技术方案</strong>：</p><div class="language-yaml vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">yaml</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">分词工具</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">Jieba 分词</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">分词模式</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">  精确模式</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">    用途</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">搜索词分词</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">    特点</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">将句子最精确地切开，适合文本分析</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">    示例</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;我来到北京清华大学&quot;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> → [&quot;我&quot;, &quot;来到&quot;, &quot;北京&quot;, &quot;清华大学&quot;]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    </span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">  全模式</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">    用途</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">构建搜索索引</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">    特点</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">扫描出所有可能成词的词语，速度快</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">    示例</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;我来到北京清华大学&quot;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> → [&quot;我&quot;, &quot;来到&quot;, &quot;北京&quot;, &quot;清华&quot;, &quot;华大&quot;, &quot;大学&quot;]</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">分词词库</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">  基础词库</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">Jieba 内置词库</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">  自定义词库</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">轻舟后台分词库</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  </span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">词库干预</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">  场景</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">分词不准导致召回问题</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">  方法</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">通过分词词库进行干预</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">  示例</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    - </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">添加专有名词</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    - </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">添加行业术语</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br></div></div><p><strong>分词流程</strong>：</p><div class="language- vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>用户输入</span></span>
<span class="line"><span>   ↓</span></span>
<span class="line"><span>预处理（去空格、统一大小写）</span></span>
<span class="line"><span>   ↓</span></span>
<span class="line"><span>Jieba 分词</span></span>
<span class="line"><span>   ↓</span></span>
<span class="line"><span>自定义词库匹配</span></span>
<span class="line"><span>   ↓</span></span>
<span class="line"><span>分词结果</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><h4 id="_3-2-2-同义词" tabindex="-1">3.2.2 同义词 <a class="header-anchor" href="#_3-2-2-同义词" aria-label="Permalink to &quot;3.2.2 同义词&quot;">​</a></h4><p><strong>定义</strong>：对同近义表达的 Query 进行语义归一</p><p><img src="`+d+`" alt="同义词示例"></p><p><strong>作用</strong>：</p><blockquote><p>解决用户搜索词与内容标题/标签<strong>同含义但不同表达</strong>导致内容召回不全的问题</p></blockquote><p><strong>技术方案</strong>：</p><div class="language-yaml vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">yaml</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">实现方式</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  - </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">基于同义词表映射</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  - </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">对 Query 进行改写</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  </span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">词库来源</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  - </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">Jieba 分词后的词</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  - </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">匹配轻舟后台同义词库</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  </span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">映射示例</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">  &quot;手机&quot;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> → [&quot;手机&quot;, &quot;移动电话&quot;, &quot;mobile phone&quot;]</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">  &quot;海报&quot;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> → [&quot;海报&quot;, &quot;宣传画&quot;, &quot;poster&quot;]</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div><p><strong>同义词改写示例</strong>：</p><div class="language- vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>原始 Query: &quot;手机海报&quot;</span></span>
<span class="line"><span>   ↓</span></span>
<span class="line"><span>分词: [&quot;手机&quot;, &quot;海报&quot;]</span></span>
<span class="line"><span>   ↓</span></span>
<span class="line"><span>同义词扩展:</span></span>
<span class="line"><span>  &quot;手机&quot; → [&quot;手机&quot;, &quot;移动电话&quot;]</span></span>
<span class="line"><span>  &quot;海报&quot; → [&quot;海报&quot;, &quot;宣传画&quot;]</span></span>
<span class="line"><span>   ↓</span></span>
<span class="line"><span>改写后 Query:</span></span>
<span class="line"><span>  - &quot;手机 海报&quot;</span></span>
<span class="line"><span>  - &quot;移动电话 海报&quot;</span></span>
<span class="line"><span>  - &quot;手机 宣传画&quot;</span></span>
<span class="line"><span>  - &quot;移动电话 宣传画&quot;</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br></div></div><hr><h3 id="_3-3-召回策略" tabindex="-1">3.3 召回策略 <a class="header-anchor" href="#_3-3-召回策略" aria-label="Permalink to &quot;3.3 召回策略&quot;">​</a></h3><p><strong>目标</strong>：从海量内容中筛选出相关内容</p><h4 id="_3-3-1-文本召回-lr-排序" tabindex="-1">3.3.1 文本召回 + LR 排序 <a class="header-anchor" href="#_3-3-1-文本召回-lr-排序" aria-label="Permalink to &quot;3.3.1 文本召回 + LR 排序&quot;">​</a></h4><p><strong>定义</strong>：基于文本匹配的召回，并使用 LR 模型进行初步排序</p><p><strong>召回流程</strong>：</p><div class="language- vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>Query（分词 + 同义词）</span></span>
<span class="line"><span>   ↓</span></span>
<span class="line"><span>文本匹配</span></span>
<span class="line"><span>   ↓</span></span>
<span class="line"><span>召回候选集</span></span>
<span class="line"><span>   ↓</span></span>
<span class="line"><span>LR 模型打分</span></span>
<span class="line"><span>   ↓</span></span>
<span class="line"><span>按 LR 分数排序</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><p><strong>技术细节</strong>：</p><div class="language-yaml vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">yaml</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">数据源</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  - </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">与稿定使用同一个词库</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  </span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">优化策略</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  - </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">对拼信内容在召回时进行打压</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  - </span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">参考</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: [</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">20241030 花瓣搜索文本召回词拓展切换为新数据源及逻辑优化</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  </span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">LR 排序特征</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  - </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">文本相关性得分</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  - </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">内容热度</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  - </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">用户行为（点击、采集、下载）</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  - </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">内容质量分</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br></div></div><p><strong>LR 模型特征和权重</strong>：</p><p><img src="`+c+`" alt="LR 特征"></p><table tabindex="0"><thead><tr><th>特征类别</th><th>特征名称</th><th>权重</th><th>说明</th></tr></thead><tbody><tr><td><strong>文本相关性</strong></td><td>Query-Title 匹配度</td><td>高</td><td>Query 与标题的匹配程度</td></tr><tr><td></td><td>Query-Tag 匹配度</td><td>中</td><td>Query 与标签的匹配程度</td></tr><tr><td><strong>内容热度</strong></td><td>点击数</td><td>高</td><td>内容被点击的次数</td></tr><tr><td></td><td>采集数</td><td>高</td><td>内容被采集的次数</td></tr><tr><td></td><td>下载数</td><td>中</td><td>内容被下载的次数</td></tr><tr><td><strong>内容质量</strong></td><td>清晰度</td><td>中</td><td>图片清晰度</td></tr><tr><td></td><td>审美分</td><td>低</td><td>内容审美评分</td></tr></tbody></table><h4 id="_3-3-2-业务池召回" tabindex="-1">3.3.2 业务池召回 <a class="header-anchor" href="#_3-3-2-业务池召回" aria-label="Permalink to &quot;3.3.2 业务池召回&quot;">​</a></h4><p><strong>定义</strong>：基于业务规则的内容召回</p><p><strong>配置方式</strong>：</p><div class="language-yaml vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">yaml</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">配置后台</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">轻舟 - 流量比例管理后台</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">配置项</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  - </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">内容范围限制</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  - </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">召回比例</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  </span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">实现方式</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">  业务池优先召回 → 多目标过滤 → 文本召回兜底补充</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><h4 id="_3-3-3-多目标召回" tabindex="-1">3.3.3 多目标召回 <a class="header-anchor" href="#_3-3-3-多目标召回" aria-label="Permalink to &quot;3.3.3 多目标召回&quot;">​</a></h4><p><strong>定义</strong>：个性化多目标召回，针对不同用户和场景召回不同数量的内容</p><p><strong>召回数量策略</strong>：</p><p><img src="`+E+`" alt="多目标召回"></p><div class="language-yaml vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">yaml</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">召回规则</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">  满足以下任一条件召回 240 个</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">    条件 1 - 用户类型</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      - </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">首访新客</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      - </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">未注册老客</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      - </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">会员老客</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">      （通过用户分群实现）</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      </span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">    条件 2 - 搜索词特征</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      - </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">近 90 天曝光 UV &gt; 20</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      - </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">PV &gt; 1000</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      - </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">UV CTR &lt; 阈值</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      - </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">素材 UV CTR &lt; 阈值</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">      （算法提供表）</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  </span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">  低搜词场景（召回 120 个）</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">    定义</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">近一周搜索 PV 排序在 TOP 5W 以后的词</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">    策略</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">召回多目标向量 120 个</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">    融合</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">多目标优先于文本，融合后总数 800 个</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  </span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">  其他情况</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">    召回数量</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">15 个</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br></div></div><p><strong>相关链接</strong>：</p><ul><li>[召回_多目标召回]</li><li>[20250515 花瓣搜索召回路比例调整及业务池支持多目标召回（需ab）]</li></ul><h4 id="_3-3-4-扶持分重排" tabindex="-1">3.3.4 扶持分重排 <a class="header-anchor" href="#_3-3-4-扶持分重排" aria-label="Permalink to &quot;3.3.4 扶持分重排&quot;">​</a></h4><p><strong>定义</strong>：根据扶持分对召回结果进行重新排序</p><p><strong>实施策略</strong>：</p><div class="language-yaml vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">yaml</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">适用范围</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  - </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">灵感多目标召回</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  - </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">素材多目标召回</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  - </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">灵感文本召回</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  - </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">素材文本召回</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  </span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">重排规则</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">  步骤 1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">多召回 300 个</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">  步骤 2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">根据扶持分进行分档</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    - </span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">扶持程度高</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">一档</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    - </span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">扶持程度中</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">一档</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    - </span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">扶持程度低</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">一档</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">  步骤 3</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">档内排序</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    - </span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">多目标/业务池</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">按原向量分/LR 分排序</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    - </span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">文本召回</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">按召回分和扶持分加权排序</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">  步骤 4</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">取对应数量进行融合</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  </span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">优先级</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">  扶持程度高 &gt; 扶持程度中 &gt; 扶持程度低</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br></div></div><p><strong>实现示例</strong>：</p><div class="language-python vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 伪代码</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">def</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> rerank_by_support_score</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(results, target_count):</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    # 1. 多召回 300 个</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    extended_results </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> recall(target_count </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">+</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 300</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    </span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    # 2. 按扶持分分档</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    high_support </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> filter</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(extended_results, </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">support_level</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;high&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    medium_support </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> filter</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(extended_results, </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">support_level</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;medium&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    low_support </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> filter</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(extended_results, </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">support_level</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;low&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    </span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    # 3. 档内排序</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    high_support </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> sort(high_support, </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">by</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;recall_score&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    medium_support </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> sort(medium_support, </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">by</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;recall_score&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    low_support </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> sort(low_support, </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">by</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;recall_score&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    </span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    # 4. 合并并截取</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    reranked </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> high_support </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">+</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> medium_support </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">+</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> low_support</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    return</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> reranked[:target_count]</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br></div></div><p><strong>相关链接</strong>：</p><ul><li>[20250115 花瓣搜索采集tab素材比例根据策略进行动态调整（需ab）]</li></ul><hr><h3 id="_3-4-精排-多目标排序" tabindex="-1">3.4 精排 - 多目标排序 <a class="header-anchor" href="#_3-4-精排-多目标排序" aria-label="Permalink to &quot;3.4 精排 - 多目标排序&quot;">​</a></h3><p><strong>定义</strong>：基于用户行为预估，进行个性化排序</p><p><strong>预估目标</strong>：</p><div class="language- vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>用户行为预估:</span></span>
<span class="line"><span>  - 点击概率</span></span>
<span class="line"><span>  - 采集概率</span></span>
<span class="line"><span>  - 下载概率</span></span>
<span class="line"><span>  - 付费概率</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p><strong>模型架构</strong>：</p><div class="language- vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>用户特征 + Query 特征 + 内容特征</span></span>
<span class="line"><span>   ↓</span></span>
<span class="line"><span>深度学习模型（Multi-Task Learning）</span></span>
<span class="line"><span>   ↓</span></span>
<span class="line"><span>多目标预估得分</span></span>
<span class="line"><span>   ↓</span></span>
<span class="line"><span>加权融合</span></span>
<span class="line"><span>   ↓</span></span>
<span class="line"><span>最终排序分数</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><p><strong>相关文档</strong>：</p><ul><li><a href="https://doc.huanleguang.com/wiki/pages/viewpage.action?pageId=248343892" target="_blank" rel="noreferrer">L3: 个性化排序</a></li></ul><hr><h3 id="_3-5-重排-策略调整" tabindex="-1">3.5 重排 - 策略调整 <a class="header-anchor" href="#_3-5-重排-策略调整" aria-label="Permalink to &quot;3.5 重排 - 策略调整&quot;">​</a></h3><p><strong>目标</strong>：基于业务策略对排序结果进行调整</p><h4 id="_3-5-1-l4-分重排" tabindex="-1">3.5.1 L4 分重排 <a class="header-anchor" href="#_3-5-1-l4-分重排" aria-label="Permalink to &quot;3.5.1 L4 分重排&quot;">​</a></h4><p><strong>定义</strong>：综合多目标得分和业务策略的最终排序分数</p><p><strong>支持的目标</strong>：</p><div class="language-yaml vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">yaml</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">多目标</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  - </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">点击</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  - </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">采集</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  - </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">下载</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  - </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">付费</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  - </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">扶持分</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  </span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">特殊策略</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">  会员用户</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">自产内容加权</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><p><strong>会员自产内容加权</strong>：</p><div class="language-yaml vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">yaml</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">策略</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">20240516 花瓣搜索针对会员用户增加自产素材的排序权重</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">规则</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">  用户类型</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">会员用户</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">  内容类型</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">自产素材</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">  操作</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">排序权重 +X</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><h4 id="_3-5-2-比例混排" tabindex="-1">3.5.2 比例混排 <a class="header-anchor" href="#_3-5-2-比例混排" aria-label="Permalink to &quot;3.5.2 比例混排&quot;">​</a></h4><p><strong>定义</strong>：根据搜索词特征动态调整素材在结果中的比例</p><p><strong>混排策略</strong>：</p><p><img src="`+b+`" alt="比例混排策略"></p><table tabindex="0"><thead><tr><th>搜索词类型</th><th>判断条件</th><th>素材比例</th></tr></thead><tbody><tr><td><strong>高差异词 A</strong></td><td>灵感和素材 PV CTR 差值 ∈ [0.01, 0.02)</td><td>无非会员下载: 15%<br>有非会员下载: 20%</td></tr><tr><td><strong>高差异词 B</strong></td><td>灵感和素材 PV CTR 差值 ∈ [0.02, 0.03)</td><td>无非会员下载: 15%<br>有非会员下载: 15%</td></tr><tr><td><strong>中差异词 A</strong></td><td>灵感和素材 PV CTR 差值 ∈ [0.03, 0.04)</td><td>无非会员下载: 5%<br>有非会员下载: 10%</td></tr><tr><td><strong>中差异词 B</strong></td><td>灵感和素材 PV CTR 差值 ∈ [0.04, 0.05)</td><td>无非会员下载: 5%<br>有非会员下载: 10%</td></tr><tr><td><strong>中差异词 C</strong></td><td>灵感和素材 PV CTR 差值 ∈ [0.05, 0.06)</td><td>无非会员下载: 5%<br>有非会员下载: 10%</td></tr><tr><td><strong>中差异词 D</strong></td><td>灵感和素材 PV CTR 差值 ∈ [0.06, 0.07)</td><td>无非会员下载: 5%<br>有非会员下载: 10%</td></tr><tr><td><strong>高差异词 C</strong></td><td>灵感和素材 PV CTR 差值 ∈ [0.07, 0.08)</td><td>无非会员下载: 5%<br>有非会员下载: 10%</td></tr><tr><td><strong>极高差异词</strong></td><td>灵感和素材 PV CTR 差值 &gt;= 0.08</td><td>无非会员下载: 5%<br>有非会员下载: 10%</td></tr><tr><td><strong>其他情况</strong></td><td>不符合以上条件</td><td>30%</td></tr></tbody></table><p><strong>策略说明</strong>：</p><div class="language- vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>核心思路:</span></span>
<span class="line"><span>  - PV CTR 差值越大 → 用户对灵感/素材的偏好越明显</span></span>
<span class="line"><span>  - 有非会员下载 → 素材质量较高 → 适当提升素材比例</span></span>
<span class="line"><span>  - 其他情况 → 默认 30% 素材比例</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p><strong>相关链接</strong>：</p><ul><li>[20250115 花瓣搜索采集tab素材比例根据策略进行动态调整（需ab）]</li></ul><hr><h3 id="_3-6-搜索链路整体流程图" tabindex="-1">3.6 搜索链路整体流程图 <a class="header-anchor" href="#_3-6-搜索链路整体流程图" aria-label="Permalink to &quot;3.6 搜索链路整体流程图&quot;">​</a></h3><p><strong>完整流程</strong>：</p><div class="language- vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>用户输入 Query</span></span>
<span class="line"><span>   ↓</span></span>
<span class="line"><span>┌──────────────────────────────────┐</span></span>
<span class="line"><span>│  搜索前置引导                     │</span></span>
<span class="line"><span>│  • 搜索热词                      │</span></span>
<span class="line"><span>│  • 历史搜索词                    │</span></span>
<span class="line"><span>└────────────┬─────────────────────┘</span></span>
<span class="line"><span>             │</span></span>
<span class="line"><span>             ↓</span></span>
<span class="line"><span>┌──────────────────────────────────┐</span></span>
<span class="line"><span>│  搜索理解                        │</span></span>
<span class="line"><span>│  • 分词（Jieba 精确模式）        │</span></span>
<span class="line"><span>│  • 同义词映射                    │</span></span>
<span class="line"><span>└────────────┬─────────────────────┘</span></span>
<span class="line"><span>             │</span></span>
<span class="line"><span>             ↓</span></span>
<span class="line"><span>┌──────────────────────────────────┐</span></span>
<span class="line"><span>│  召回                            │</span></span>
<span class="line"><span>│  • 文本召回（300个）             │</span></span>
<span class="line"><span>│  • 多目标召回（240/120/15个）    │</span></span>
<span class="line"><span>│  • 业务池召回                    │</span></span>
<span class="line"><span>│  ↓                               │</span></span>
<span class="line"><span>│  扶持分重排（+300个）             │</span></span>
<span class="line"><span>└────────────┬─────────────────────┘</span></span>
<span class="line"><span>             │</span></span>
<span class="line"><span>             ↓</span></span>
<span class="line"><span>┌──────────────────────────────────┐</span></span>
<span class="line"><span>│  粗排                            │</span></span>
<span class="line"><span>│  • LR 模型打分                   │</span></span>
<span class="line"><span>│  • 按 LR 分排序                  │</span></span>
<span class="line"><span>└────────────┬─────────────────────┘</span></span>
<span class="line"><span>             │</span></span>
<span class="line"><span>             ↓</span></span>
<span class="line"><span>┌──────────────────────────────────┐</span></span>
<span class="line"><span>│  精排                            │</span></span>
<span class="line"><span>│  • 多目标排序模型                │</span></span>
<span class="line"><span>│  • 预估点击/采集/下载/付费概率   │</span></span>
<span class="line"><span>└────────────┬─────────────────────┘</span></span>
<span class="line"><span>             │</span></span>
<span class="line"><span>             ↓</span></span>
<span class="line"><span>┌──────────────────────────────────┐</span></span>
<span class="line"><span>│  重排                            │</span></span>
<span class="line"><span>│  • L4 分计算                     │</span></span>
<span class="line"><span>│  • 会员自产内容加权              │</span></span>
<span class="line"><span>└────────────┬─────────────────────┘</span></span>
<span class="line"><span>             │</span></span>
<span class="line"><span>             ↓</span></span>
<span class="line"><span>┌──────────────────────────────────┐</span></span>
<span class="line"><span>│  策略调整                        │</span></span>
<span class="line"><span>│  • 比例混排（灵感/素材）         │</span></span>
<span class="line"><span>│  • 素材比例动态调整              │</span></span>
<span class="line"><span>└────────────┬─────────────────────┘</span></span>
<span class="line"><span>             │</span></span>
<span class="line"><span>             ↓</span></span>
<span class="line"><span>       搜索结果展示</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br></div></div><hr><h2 id="四、模板搜索" tabindex="-1">四、模板搜索 <a class="header-anchor" href="#四、模板搜索" aria-label="Permalink to &quot;四、模板搜索&quot;">​</a></h2><h3 id="_4-1-实现方案" tabindex="-1">4.1 实现方案 <a class="header-anchor" href="#_4-1-实现方案" aria-label="Permalink to &quot;4.1 实现方案&quot;">​</a></h3><p><strong>技术方案</strong>：</p><div class="language-yaml vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">yaml</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">接口来源</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  - </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">复用稿定模板搜索接口</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  - </span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">接口文档</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: [</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">02 搜索能力_介绍与接入</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  </span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">模型训练</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">  数据增强</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">增加花瓣侧模板搜索数据</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">  训练数据</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">花瓣用户搜索行为 + 稿定用户搜索行为</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  </span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">优化同步</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  - </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">稿定模板搜索的优化会同步到花瓣</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  - </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">统一维护，降低成本</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div><h3 id="_4-2-差异点" tabindex="-1">4.2 差异点 <a class="header-anchor" href="#_4-2-差异点" aria-label="Permalink to &quot;4.2 差异点&quot;">​</a></h3><table tabindex="0"><thead><tr><th>维度</th><th>稿定模板搜索</th><th>花瓣模板搜索</th></tr></thead><tbody><tr><td><strong>用户群体</strong></td><td>设计师为主</td><td>普通用户为主</td></tr><tr><td><strong>搜索意图</strong></td><td>专业设计需求</td><td>灵感和设计需求</td></tr><tr><td><strong>训练数据</strong></td><td>稿定搜索数据</td><td>稿定 + 花瓣搜索数据</td></tr><tr><td><strong>接口</strong></td><td>稿定搜索接口</td><td>同稿定接口</td></tr></tbody></table><hr><h2 id="五、总结与展望" tabindex="-1">五、总结与展望 <a class="header-anchor" href="#五、总结与展望" aria-label="Permalink to &quot;五、总结与展望&quot;">​</a></h2><h3 id="_5-1-核心能力总结" tabindex="-1">5.1 核心能力总结 <a class="header-anchor" href="#_5-1-核心能力总结" aria-label="Permalink to &quot;5.1 核心能力总结&quot;">​</a></h3><p><strong>搜索引导</strong>：</p><ul><li>✅ 搜索热词：基于热度推荐</li><li>✅ 搜索联想：减少输入成本</li><li>✅ 搜索推荐：无结果时引导</li></ul><p><strong>搜索理解</strong>：</p><ul><li>✅ 分词：Jieba 精确模式</li><li>✅ 同义词：语义归一</li></ul><p><strong>召回策略</strong>：</p><ul><li>✅ 文本召回：基于关键词匹配</li><li>✅ 多目标召回：个性化召回</li><li>✅ 业务池召回：业务规则召回</li><li>✅ 扶持分重排：内容扶持</li></ul><p><strong>排序策略</strong>：</p><ul><li>✅ 粗排：LR 模型</li><li>✅ 精排：多目标排序</li><li>✅ 重排：L4 分 + 业务策略</li><li>✅ 比例混排：动态调整素材比例</li></ul><h3 id="_5-2-数据指标" tabindex="-1">5.2 数据指标 <a class="header-anchor" href="#_5-2-数据指标" aria-label="Permalink to &quot;5.2 数据指标&quot;">​</a></h3><p><strong>搜索使用情况</strong>：</p><div class="language- vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>使用率: 近 60% 的花瓣访客使用搜索</span></span>
<span class="line"><span>访问量: 搜索结果页为花瓣第二大流量页面</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p><strong>核心指标</strong>：</p><table tabindex="0"><thead><tr><th>指标</th><th>说明</th><th>目标</th></tr></thead><tbody><tr><td><strong>UV CTR</strong></td><td>去重点击率</td><td>提升用户真实点击</td></tr><tr><td><strong>PV CTR</strong></td><td>页面点击率</td><td>提升整体点击</td></tr><tr><td><strong>下载率</strong></td><td>下载转化率</td><td>提升付费转化</td></tr><tr><td><strong>付费率</strong></td><td>付费转化率</td><td>提升商业价值</td></tr></tbody></table><h3 id="_5-3-未来优化方向" tabindex="-1">5.3 未来优化方向 <a class="header-anchor" href="#_5-3-未来优化方向" aria-label="Permalink to &quot;5.3 未来优化方向&quot;">​</a></h3><p><strong>搜索理解</strong>：</p><ul><li>🔄 深度语义理解（BERT）</li><li>🔄 意图识别</li><li>🔄 Query 改写优化</li></ul><p><strong>召回优化</strong>：</p><ul><li>🔄 向量召回优化</li><li>🔄 混合召回策略</li><li>🔄 召回多样性提升</li></ul><p><strong>排序优化</strong>：</p><ul><li>🔄 深度学习排序模型</li><li>🔄 实时特征引入</li><li>🔄 多目标平衡优化</li></ul><p><strong>策略优化</strong>：</p><ul><li>🔄 精细化比例控制</li><li>🔄 个性化策略</li><li>🔄 实时 AB 测试</li></ul><hr><h2 id="六、参考资料" tabindex="-1">六、参考资料 <a class="header-anchor" href="#六、参考资料" aria-label="Permalink to &quot;六、参考资料&quot;">​</a></h2><p><strong>内部文档</strong>：</p><ul><li><a href="https://doc.huanleguang.com/wiki/pages/viewpage.action?pageId=248343892" target="_blank" rel="noreferrer">L3: 个性化排序</a></li><li>[02 搜索能力_介绍与接入]</li><li>[20241030 花瓣搜索文本召回词拓展切换为新数据源及逻辑优化]</li><li>[召回_多目标召回]</li><li>[20250515 花瓣搜索召回路比例调整及业务池支持多目标召回]</li><li>[20250115 花瓣搜索采集tab素材比例根据策略进行动态调整]</li><li>[20240516 花瓣搜索针对会员用户增加自产素材的排序权重]</li></ul><p><strong>原始文档</strong>：</p><ul><li><a href="https://doc.huanleguang.com/pages/viewpage.action?pageId=286485554" target="_blank" rel="noreferrer">Confluence: 花瓣搜索能力介绍</a></li></ul><hr><p><strong>文档维护</strong>：搜索算法团队<br><strong>文档整理</strong>：前端基建团队<br><strong>创建日期</strong>：2023-03-08<br><strong>整理日期</strong>：2025-01-25<br><strong>文档版本</strong>：v2.0</p>`,192)]))}const A=a(g,[["render",u]]);export{_ as __pageData,A as default};
