import{_ as e,C as l,c as p,o as i,a7 as a,b as h,w as t,a as d,G as r,a9 as k}from"./chunks/framework.BQb8NfN9.js";const E="/Lyc-notes/assets/image2025-8-8_17-5-16.B9R-Gq6_.png",_=JSON.parse('{"title":"Agent é“¾è·¯è¿½è¸ªä¸ç›‘æ§","description":"","frontmatter":{},"headers":[],"relativePath":"work/gd/Agent/05-å¯è§‚æµ‹æ€§/é“¾è·¯è¿½è¸ªä¸ç›‘æ§.md","filePath":"work/gd/Agent/05-å¯è§‚æµ‹æ€§/é“¾è·¯è¿½è¸ªä¸ç›‘æ§.md","lastUpdated":1770085732000}'),o={name:"work/gd/Agent/05-å¯è§‚æµ‹æ€§/é“¾è·¯è¿½è¸ªä¸ç›‘æ§.md"};function g(c,s,u,b,y,F){const n=l("Mermaid");return i(),p("div",null,[s[1]||(s[1]=a('<h1 id="agent-é“¾è·¯è¿½è¸ªä¸ç›‘æ§" tabindex="-1">Agent é“¾è·¯è¿½è¸ªä¸ç›‘æ§ <a class="header-anchor" href="#agent-é“¾è·¯è¿½è¸ªä¸ç›‘æ§" aria-label="Permalink to &quot;Agent é“¾è·¯è¿½è¸ªä¸ç›‘æ§&quot;">â€‹</a></h1><h2 id="ä¸€ã€æ¦‚è¿°" tabindex="-1">ä¸€ã€æ¦‚è¿° <a class="header-anchor" href="#ä¸€ã€æ¦‚è¿°" aria-label="Permalink to &quot;ä¸€ã€æ¦‚è¿°&quot;">â€‹</a></h2><p>æœ¬æ–‡æ¡£ä»‹ç» Agent ç³»ç»Ÿçš„å¯è§‚æµ‹æ€§æ–¹æ¡ˆï¼ŒåŒ…æ‹¬é“¾è·¯è¿½è¸ªã€æ—¥å¿—é‡‡é›†ã€ç›‘æ§æŒ‡æ ‡å’Œå‘Šè­¦è§„åˆ™ï¼Œæ”¯æ’‘ç³»ç»Ÿçš„ç¨³å®šè¿è¡Œå’Œæˆæœ¬ç®¡æ§ã€‚</p><blockquote><p>ğŸ“‹ <strong>éœ€æ±‚èƒŒæ™¯</strong><br> éœ€æ±‚ç¨¿ï¼šAgent2.0 å»ºç«‹é“¾è·¯è¿½è¸ªã€å¯è§‚æµ‹ä»¥åŠæˆæœ¬ç®¡æ§ç­‰éåŠŸèƒ½ç‰¹æ€§</p></blockquote><hr><h2 id="äºŒã€ä¸€æ¡-message-çš„ç”Ÿå‘½å‘¨æœŸ" tabindex="-1">äºŒã€ä¸€æ¡ Message çš„ç”Ÿå‘½å‘¨æœŸ <a class="header-anchor" href="#äºŒã€ä¸€æ¡-message-çš„ç”Ÿå‘½å‘¨æœŸ" aria-label="Permalink to &quot;äºŒã€ä¸€æ¡ Message çš„ç”Ÿå‘½å‘¨æœŸ&quot;">â€‹</a></h2><h3 id="_2-1-ç”Ÿå‘½å‘¨æœŸ-checkpoints" tabindex="-1">2.1 ç”Ÿå‘½å‘¨æœŸ Checkpoints <a class="header-anchor" href="#_2-1-ç”Ÿå‘½å‘¨æœŸ-checkpoints" aria-label="Permalink to &quot;2.1 ç”Ÿå‘½å‘¨æœŸ Checkpoints&quot;">â€‹</a></h3><table tabindex="0"><thead><tr><th>Checkpoint</th><th>å®šä¹‰</th><th>æ”¯æ’‘åˆ¤æ–­</th><th>æ‰€å±æ¨¡å—</th></tr></thead><tbody><tr><td><strong>è¯·æ±‚æ¥æ”¶</strong></td><td><code>request_execute_begin</code></td><td>ä¼šè¯æ•°ã€æ–°ä¼šè¯æ•°ã€è¯·æ±‚æ•°ã€é¦–æ¬¡ä»»åŠ¡å®Œæˆç‡ã€æŠ€èƒ½ä½¿ç”¨ç‡ã€æ¨¡å¼ä½¿ç”¨ç‡</td><td>Gaoding-AI-Agent</td></tr><tr><td><strong>èŠ‚ç‚¹æ‰§è¡Œ</strong></td><td><code>node_execute_begin</code> / <code>node_execute_end</code></td><td>èŠ‚ç‚¹æ‰§è¡ŒæˆåŠŸç‡ã€èŠ‚ç‚¹æ‰§è¡Œè€—æ—¶</td><td>Gaoding-AI-Agent</td></tr><tr><td><strong>LLM è°ƒç”¨</strong></td><td><code>llm_execute_begin</code> / <code>llm_execute_end</code></td><td>æ¨¡å‹ token æ¶ˆè€—ã€æ¨¡å‹å“åº”è€—æ—¶</td><td>Gaoding-AI-Agent</td></tr><tr><td><strong>å·¥å…·è°ƒç”¨</strong></td><td><code>tool_execute_begin</code> / <code>tool_execute_end</code></td><td>å·¥å…·è°ƒç”¨æˆåŠŸç‡ã€å·¥å…·è°ƒç”¨è€—æ—¶</td><td>Gaoding-AI-Agent, gdesign-tool</td></tr><tr><td><strong>è¯·æ±‚å®Œæˆ</strong></td><td><code>request_execute_end</code></td><td>è¯·æ±‚å¤„ç†æ—¶é•¿</td><td>Gaoding-AI-Agent</td></tr><tr><td><strong>ç”¨æˆ·ä¸‹è½½/å¯¼å‡º</strong></td><td><em>å¤ç”¨æ•°æ®é€šè·¯ä¸ŠæŠ¥</em></td><td>é‡‡çº³ç‡ / è½¬åŒ–æ¼æ–—</td><td>å‰ç«¯</td></tr><tr><td><strong>ç”¨æˆ·ä¸­æ–­</strong></td><td><code>user_stop_streaming</code></td><td>ä»»åŠ¡æœªå®Œæˆç‡ï¼ˆç”Ÿæˆä¸­ä¸»åŠ¨é€€å‡ºï¼‰</td><td>å‰ç«¯</td></tr></tbody></table><h3 id="_2-2-ç”Ÿå‘½å‘¨æœŸæµç¨‹å›¾" tabindex="-1">2.2 ç”Ÿå‘½å‘¨æœŸæµç¨‹å›¾ <a class="header-anchor" href="#_2-2-ç”Ÿå‘½å‘¨æœŸæµç¨‹å›¾" aria-label="Permalink to &quot;2.2 ç”Ÿå‘½å‘¨æœŸæµç¨‹å›¾&quot;">â€‹</a></h3>',9)),(i(),h(k,null,{default:t(()=>[r(n,{id:"mermaid-142",class:"mermaid",graph:"sequenceDiagram%0A%20%20%20%20participant%20User%0A%20%20%20%20participant%20Frontend%0A%20%20%20%20participant%20Agent%0A%20%20%20%20participant%20LLM%0A%20%20%20%20participant%20Tool%0A%0A%20%20%20%20User-%3E%3EFrontend%3A%20%E5%8F%91%E9%80%81%E6%B6%88%E6%81%AF%0A%20%20%20%20Frontend-%3E%3EAgent%3A%20request_execute_begin%0A%20%20%20%20%0A%20%20%20%20Agent-%3E%3EAgent%3A%20node_execute_begin%0A%20%20%20%20Agent-%3E%3ELLM%3A%20llm_execute_begin%0A%20%20%20%20LLM--%3E%3EAgent%3A%20llm_execute_end%0A%20%20%20%20Agent-%3E%3EAgent%3A%20node_execute_end%0A%20%20%20%20%0A%20%20%20%20Agent-%3E%3EAgent%3A%20node_execute_begin%20(tool%E8%8A%82%E7%82%B9)%0A%20%20%20%20Agent-%3E%3ETool%3A%20tool_execute_begin%0A%20%20%20%20Tool--%3E%3EAgent%3A%20tool_execute_end%0A%20%20%20%20Agent-%3E%3EAgent%3A%20node_execute_end%0A%20%20%20%20%0A%20%20%20%20Agent-%3E%3EFrontend%3A%20request_execute_end%0A%20%20%20%20Frontend-%3E%3EUser%3A%20%E6%98%BE%E7%A4%BA%E7%BB%93%E6%9E%9C%0A%20%20%20%20%0A%20%20%20%20alt%20%E7%94%A8%E6%88%B7%E4%B8%8B%E8%BD%BD%0A%20%20%20%20%20%20%20%20User-%3E%3EFrontend%3A%20%E4%B8%8B%E8%BD%BD%2F%E5%AF%BC%E5%87%BA%0A%20%20%20%20%20%20%20%20Frontend-%3E%3E%E6%95%B0%E6%8D%AE%E9%80%9A%E8%B7%AF%3A%20%E4%B8%8A%E6%8A%A5%E8%BD%AC%E5%8C%96%0A%20%20%20%20end%0A%20%20%20%20%0A%20%20%20%20alt%20%E7%94%A8%E6%88%B7%E4%B8%AD%E6%96%AD%0A%20%20%20%20%20%20%20%20User-%3E%3EFrontend%3A%20%E5%81%9C%E6%AD%A2%E7%94%9F%E6%88%90%0A%20%20%20%20%20%20%20%20Frontend-%3E%3EAgent%3A%20user_stop_streaming%0A%20%20%20%20end%0A"})]),fallback:t(()=>s[0]||(s[0]=[d(" Loading... ")])),_:1})),s[2]||(s[2]=a(`<hr><h2 id="ä¸‰ã€checkpoint-è¯¦ç»†å®šä¹‰" tabindex="-1">ä¸‰ã€Checkpoint è¯¦ç»†å®šä¹‰ <a class="header-anchor" href="#ä¸‰ã€checkpoint-è¯¦ç»†å®šä¹‰" aria-label="Permalink to &quot;ä¸‰ã€Checkpoint è¯¦ç»†å®šä¹‰&quot;">â€‹</a></h2><h3 id="_3-1-è¯·æ±‚å¼€å§‹-request-execute-begin" tabindex="-1">3.1 è¯·æ±‚å¼€å§‹ (request_execute_begin) <a class="header-anchor" href="#_3-1-è¯·æ±‚å¼€å§‹-request-execute-begin" aria-label="Permalink to &quot;3.1 è¯·æ±‚å¼€å§‹ (request_execute_begin)&quot;">â€‹</a></h3><p><strong>æ—¶æœº</strong>ï¼šAgent æ”¶åˆ°ç”¨æˆ·è¯·æ±‚ï¼Œå¼€å§‹å¤„ç†</p><p><strong>å­—æ®µï¼š</strong></p><table tabindex="0"><thead><tr><th>å­—æ®µ</th><th>ç±»å‹</th><th>è¯´æ˜</th></tr></thead><tbody><tr><td><code>text</code></td><td>string</td><td>ç”¨æˆ·æŒ‡ä»¤</td></tr><tr><td><code>is_new</code></td><td>boolean</td><td>æ˜¯å¦æ˜¯æ–°ä¼šè¯</td></tr><tr><td><code>input_skill_id</code></td><td>int</td><td>ç”¨æˆ·é€‰æ‹©çš„æŠ€èƒ½ ID</td></tr><tr><td><code>mode</code></td><td>string</td><td>æ¨¡å¼ï¼šæ™®é€š / é«˜çº§</td></tr><tr><td><code>attachments</code></td><td>array</td><td>é™„ä»¶åˆ—è¡¨</td></tr></tbody></table><p><strong>ç¤ºä¾‹ï¼š</strong></p><div class="language-json vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">json</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">{</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  &quot;event&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;request_execute_begin&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  &quot;trace_id&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;trace_123&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  &quot;thread_id&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;thread_abc&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  &quot;user_id&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;user_456&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  &quot;data&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: {</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    &quot;text&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;å¸®æˆ‘ç”Ÿæˆä¸€å¼ ç‰™è†äº§å“å›¾&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    &quot;is_new&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">true</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    &quot;input_skill_id&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    &quot;mode&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;normal&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    &quot;attachments&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: []</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  },</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  &quot;timestamp&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;2025-07-08T12:00:00Z&quot;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br></div></div><h3 id="_3-2-èŠ‚ç‚¹æ‰§è¡Œ-node-execute-begin-node-execute-end" tabindex="-1">3.2 èŠ‚ç‚¹æ‰§è¡Œ (node_execute_begin / node_execute_end) <a class="header-anchor" href="#_3-2-èŠ‚ç‚¹æ‰§è¡Œ-node-execute-begin-node-execute-end" aria-label="Permalink to &quot;3.2 èŠ‚ç‚¹æ‰§è¡Œ (node_execute_begin / node_execute_end)&quot;">â€‹</a></h3><p><strong>æ—¶æœº</strong>ï¼šAgent å·¥ä½œæµèŠ‚ç‚¹æ‰§è¡Œå‰å</p><p><strong>å¼€å§‹å­—æ®µï¼š</strong></p><table tabindex="0"><thead><tr><th>å­—æ®µ</th><th>ç±»å‹</th><th>è¯´æ˜</th></tr></thead><tbody><tr><td><code>graph_name</code></td><td>string</td><td>å·¥ä½œæµåç§°</td></tr><tr><td><code>node_name</code></td><td>string</td><td>èŠ‚ç‚¹åç§°</td></tr></tbody></table><p><strong>ç»“æŸå­—æ®µï¼š</strong></p><table tabindex="0"><thead><tr><th>å­—æ®µ</th><th>ç±»å‹</th><th>è¯´æ˜</th></tr></thead><tbody><tr><td><code>graph_name</code></td><td>string</td><td>å·¥ä½œæµåç§°</td></tr><tr><td><code>node_name</code></td><td>string</td><td>èŠ‚ç‚¹åç§°</td></tr><tr><td><code>duration_ms</code></td><td>int</td><td>æ‰§è¡Œè€—æ—¶ï¼ˆæ¯«ç§’ï¼‰</td></tr><tr><td><code>status</code></td><td>string</td><td>æˆåŠŸ / å¤±è´¥</td></tr><tr><td><code>error</code></td><td>string</td><td>é”™è¯¯ä¿¡æ¯ï¼ˆå¦‚æœå¤±è´¥ï¼‰</td></tr></tbody></table><p><strong>ç¤ºä¾‹ï¼š</strong></p><div class="language-json vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">json</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">{</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  &quot;event&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;node_execute_begin&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  &quot;trace_id&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;trace_123&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  &quot;data&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: {</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    &quot;graph_name&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;image_generation_workflow&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    &quot;node_name&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;generate_prompt&quot;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  },</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  &quot;timestamp&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;2025-07-08T12:00:01Z&quot;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><h3 id="_3-3-llm-è°ƒç”¨-llm-execute-begin-llm-execute-end" tabindex="-1">3.3 LLM è°ƒç”¨ (llm_execute_begin / llm_execute_end) <a class="header-anchor" href="#_3-3-llm-è°ƒç”¨-llm-execute-begin-llm-execute-end" aria-label="Permalink to &quot;3.3 LLM è°ƒç”¨ (llm_execute_begin / llm_execute_end)&quot;">â€‹</a></h3><p><strong>æ—¶æœº</strong>ï¼šAgent è°ƒç”¨æ¨¡å‹å‰å</p><p><strong>å¼€å§‹å­—æ®µï¼š</strong></p><table tabindex="0"><thead><tr><th>å­—æ®µ</th><th>ç±»å‹</th><th>è¯´æ˜</th></tr></thead><tbody><tr><td><code>model_name</code></td><td>string</td><td>ä½¿ç”¨çš„æ¨¡å‹å</td></tr><tr><td><code>original_messages</code></td><td>array</td><td>åŸå§‹çš„ messagesï¼ˆä»…é prod ç¯å¢ƒï¼‰</td></tr><tr><td><code>llm_messages</code></td><td>array</td><td>é¢å‘ LLM çš„æ¶ˆæ¯ï¼ˆä»…é prod ç¯å¢ƒï¼‰</td></tr></tbody></table><p><strong>ç»“æŸå­—æ®µï¼š</strong></p><table tabindex="0"><thead><tr><th>å­—æ®µ</th><th>ç±»å‹</th><th>è¯´æ˜</th></tr></thead><tbody><tr><td><code>llm_calls_num</code></td><td>int</td><td>è¿­ä»£æ¬¡æ•°</td></tr><tr><td><code>prompt_tokens</code></td><td>int</td><td>è¾“å…¥ tokens</td></tr><tr><td><code>completion_tokens</code></td><td>int</td><td>è¾“å‡º tokens</td></tr><tr><td><code>reasoning_tokens</code></td><td>int</td><td>æ€è€ƒ tokensï¼ˆreasoning æ¨¡å‹ï¼‰</td></tr><tr><td><code>cached_tokens</code></td><td>int</td><td>å‘½ä¸­ç¼“å­˜çš„ tokens æ•°é‡</td></tr><tr><td><code>text_tokens</code></td><td>int</td><td>å‘½ä¸­ç¼“å­˜çš„ text tokens æ•°é‡</td></tr><tr><td><code>messages</code></td><td>array</td><td>å“åº”çš„ messagesï¼ˆä»…é prod ç¯å¢ƒï¼‰</td></tr></tbody></table><p><strong>ç¤ºä¾‹ï¼š</strong></p><div class="language-json vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">json</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">{</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  &quot;event&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;llm_execute_end&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  &quot;trace_id&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;trace_123&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  &quot;data&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: {</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    &quot;llm_calls_num&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    &quot;prompt_tokens&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">150</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    &quot;completion_tokens&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">80</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    &quot;reasoning_tokens&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    &quot;cached_tokens&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">50</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    &quot;text_tokens&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">45</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  },</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  &quot;timestamp&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;2025-07-08T12:00:03Z&quot;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br></div></div><h3 id="_3-4-å·¥å…·è°ƒç”¨-tool-execute-begin-tool-execute-end" tabindex="-1">3.4 å·¥å…·è°ƒç”¨ (tool_execute_begin / tool_execute_end) <a class="header-anchor" href="#_3-4-å·¥å…·è°ƒç”¨-tool-execute-begin-tool-execute-end" aria-label="Permalink to &quot;3.4 å·¥å…·è°ƒç”¨ (tool_execute_begin / tool_execute_end)&quot;">â€‹</a></h3><p><strong>æ—¶æœº</strong>ï¼šAgent æˆ– gdesign-tool æ‰§è¡Œå·¥å…·å‰å</p><p><strong>å¼€å§‹å­—æ®µï¼ˆAgentï¼‰ï¼š</strong></p><table tabindex="0"><thead><tr><th>å­—æ®µ</th><th>ç±»å‹</th><th>è¯´æ˜</th></tr></thead><tbody><tr><td><code>tool_call_id</code></td><td>string</td><td>å·¥å…·è°ƒç”¨ IDï¼ˆAgent æœ¬åœ°è¯†åˆ«ï¼‰</td></tr><tr><td><code>func_name</code></td><td>string</td><td>å·¥å…·åç§°</td></tr><tr><td><code>params</code></td><td>object</td><td>è°ƒç”¨å‚æ•°</td></tr></tbody></table><p><strong>ç»“æŸå­—æ®µï¼ˆAgentï¼‰ï¼š</strong></p><table tabindex="0"><thead><tr><th>å­—æ®µ</th><th>ç±»å‹</th><th>è¯´æ˜</th></tr></thead><tbody><tr><td><code>tool_call_id</code></td><td>string</td><td>å·¥å…·è°ƒç”¨ ID</td></tr><tr><td><code>result</code></td><td>string</td><td>è°ƒç”¨ç»“æœï¼š&quot;success&quot; / &quot;failed&quot;</td></tr><tr><td><code>task_id</code></td><td>string</td><td>gdesign-tool ç”Ÿæˆçš„ä»»åŠ¡ ID</td></tr><tr><td><code>deduct_points</code></td><td>int</td><td>æ‰£é™¤çš„ç¨¿è±†æ•°</td></tr><tr><td><code>exception_message</code></td><td>string</td><td>å¼‚å¸¸ä¿¡æ¯</td></tr></tbody></table><p><strong>ç»“æŸå­—æ®µï¼ˆgdesign-toolï¼‰ï¼š</strong></p><table tabindex="0"><thead><tr><th>å­—æ®µ</th><th>ç±»å‹</th><th>è¯´æ˜</th></tr></thead><tbody><tr><td><code>trace_id</code></td><td>string</td><td>è¯·æ±‚ ID</td></tr><tr><td><code>result</code></td><td>string</td><td>&quot;success&quot; / &quot;failed&quot;</td></tr><tr><td><code>task_id</code></td><td>string</td><td>ä»»åŠ¡ ID</td></tr><tr><td><code>scene_code</code></td><td>string</td><td>å¯¹åº”è½»èˆŸçš„åœºæ™¯ code</td></tr><tr><td><code>deduct_points</code></td><td>int</td><td>æ‰£é™¤çš„ç¨¿è±†æ•°</td></tr><tr><td><code>exception_message</code></td><td>string</td><td>å¼‚å¸¸ä¿¡æ¯</td></tr></tbody></table><p><strong>ç¤ºä¾‹ï¼š</strong></p><div class="language-json vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">json</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">{</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  &quot;event&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;tool_execute_end&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  &quot;trace_id&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;trace_123&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  &quot;data&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: {</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    &quot;tool_call_id&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;tool_call_001&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    &quot;result&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;success&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    &quot;task_id&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;task_abc123&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    &quot;deduct_points&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">10</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    &quot;exception_message&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">null</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  },</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  &quot;timestamp&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;2025-07-08T12:00:05Z&quot;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br></div></div><h3 id="_3-5-è¯·æ±‚ç»“æŸ-request-execute-end" tabindex="-1">3.5 è¯·æ±‚ç»“æŸ (request_execute_end) <a class="header-anchor" href="#_3-5-è¯·æ±‚ç»“æŸ-request-execute-end" aria-label="Permalink to &quot;3.5 è¯·æ±‚ç»“æŸ (request_execute_end)&quot;">â€‹</a></h3><p><strong>æ—¶æœº</strong>ï¼šAgent å®Œæˆç”¨æˆ·è¯·æ±‚</p><p><strong>å­—æ®µï¼š</strong></p><table tabindex="0"><thead><tr><th>å­—æ®µ</th><th>ç±»å‹</th><th>è¯´æ˜</th></tr></thead><tbody><tr><td><code>reason</code></td><td>string</td><td>ç»“æŸåŸå› ï¼šcompleted / interrupted / error</td></tr></tbody></table><p><strong>ç¤ºä¾‹ï¼š</strong></p><div class="language-json vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">json</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">{</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  &quot;event&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;request_execute_end&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  &quot;trace_id&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;trace_123&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  &quot;data&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: {</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    &quot;reason&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;completed&quot;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  },</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  &quot;timestamp&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;2025-07-08T12:00:10Z&quot;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><h3 id="_3-6-ç”¨æˆ·ä¸­æ–­-user-stop-streaming" tabindex="-1">3.6 ç”¨æˆ·ä¸­æ–­ (user_stop_streaming) <a class="header-anchor" href="#_3-6-ç”¨æˆ·ä¸­æ–­-user-stop-streaming" aria-label="Permalink to &quot;3.6 ç”¨æˆ·ä¸­æ–­ (user_stop_streaming)&quot;">â€‹</a></h3><p><strong>æ—¶æœº</strong>ï¼šç”¨æˆ·ä¸»åŠ¨ä¸­æ–­è¾“å‡º</p><p><strong>å­—æ®µï¼š</strong></p><table tabindex="0"><thead><tr><th>å­—æ®µ</th><th>ç±»å‹</th><th>è¯´æ˜</th></tr></thead><tbody><tr><td><code>thread_id</code></td><td>string</td><td>ä¼šè¯ ID</td></tr><tr><td><code>user_id</code></td><td>string</td><td>ç”¨æˆ· ID</td></tr><tr><td><code>message_id</code></td><td>string</td><td>æ¶ˆæ¯ ID</td></tr></tbody></table><p><strong>ç¤ºä¾‹ï¼š</strong></p><div class="language-json vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">json</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">{</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  &quot;event&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;user_stop_streaming&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  &quot;data&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: {</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    &quot;thread_id&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;thread_abc&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    &quot;user_id&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;user_456&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    &quot;message_id&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;msg_789&quot;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  },</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  &quot;timestamp&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;2025-07-08T12:00:08Z&quot;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><hr><h2 id="å››ã€id-å…³ç³»ä¸é€ä¼ " tabindex="-1">å››ã€ID å…³ç³»ä¸é€ä¼  <a class="header-anchor" href="#å››ã€id-å…³ç³»ä¸é€ä¼ " aria-label="Permalink to &quot;å››ã€ID å…³ç³»ä¸é€ä¼ &quot;">â€‹</a></h2><h3 id="_4-1-id-ä½“ç³»" tabindex="-1">4.1 ID ä½“ç³» <a class="header-anchor" href="#_4-1-id-ä½“ç³»" aria-label="Permalink to &quot;4.1 ID ä½“ç³»&quot;">â€‹</a></h3><p><img src="`+E+`" alt=""></p><table tabindex="0"><thead><tr><th>ID ç±»å‹</th><th>ç”Ÿæˆè€…</th><th>ä½œç”¨åŸŸ</th><th>è¯´æ˜</th></tr></thead><tbody><tr><td><code>trace_id</code></td><td>Agent / Frontend</td><td>å•æ¬¡è¯·æ±‚</td><td>è¿½è¸ªå®Œæ•´è¯·æ±‚é“¾è·¯</td></tr><tr><td><code>thread_id</code></td><td>Agent</td><td>ä¼šè¯</td><td>æ ‡è¯†ä¸€ä¸ªå¯¹è¯ä¼šè¯</td></tr><tr><td><code>message_id</code></td><td>Agent</td><td>ä¼šè¯å†…</td><td>æ ‡è¯†å•æ¡æ¶ˆæ¯</td></tr><tr><td><code>tool_call_id</code></td><td>Agent</td><td>å•æ¬¡å·¥å…·è°ƒç”¨</td><td>æ ‡è¯†å·¥å…·è°ƒç”¨</td></tr><tr><td><code>task_id</code></td><td>gdesign-tool</td><td>å·¥å…·æ‰§è¡Œ</td><td>æ ‡è¯†å…·ä½“ä»»åŠ¡</td></tr></tbody></table><h3 id="_4-2-å…¬å…±ä¸ŠæŠ¥å­—æ®µ" tabindex="-1">4.2 å…¬å…±ä¸ŠæŠ¥å­—æ®µ <a class="header-anchor" href="#_4-2-å…¬å…±ä¸ŠæŠ¥å­—æ®µ" aria-label="Permalink to &quot;4.2 å…¬å…±ä¸ŠæŠ¥å­—æ®µ&quot;">â€‹</a></h3><p><strong>Gaoding-AI-Agentï¼š</strong></p><ul><li><code>trace_id</code>ï¼šè¯·æ±‚ ID</li><li><code>thread_id</code>ï¼šä¼šè¯ ID</li><li><code>user_id</code>ï¼šç”¨æˆ· ID</li></ul><p><strong>gdesign-toolï¼š</strong></p><ul><li><code>trace_id</code>ï¼šè¯·æ±‚ ID</li><li><code>func_name</code>ï¼šå·¥å…·åç§°ï¼ˆå¤ç”¨ç´¢å¼•ï¼‰</li></ul><h3 id="_4-3-task-id-å’Œ-deduct-points-é€ä¼ " tabindex="-1">4.3 task_id å’Œ deduct_points é€ä¼  <a class="header-anchor" href="#_4-3-task-id-å’Œ-deduct-points-é€ä¼ " aria-label="Permalink to &quot;4.3 task_id å’Œ deduct_points é€ä¼ &quot;">â€‹</a></h3><p>ç”±äº response body ä¸º json-rpc æ ¼å¼ï¼Œä¸æ–¹ä¾¿é€ä¼ ï¼Œ<strong>æ”¾åˆ° response header é‡Œ</strong>ï¼š</p><div class="language-python vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># gdesign-tool å“åº”</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">response.headers[</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;X-Task-ID&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">] </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> task_id</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">response.headers[</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;X-Deduct-Points&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">] </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> str</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(deduct_points)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Agent è§£æ</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">task_id </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> response.headers.get(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;X-Task-ID&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">deduct_points </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> int</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(response.headers.get(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;X-Deduct-Points&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">))</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><hr><h2 id="äº”ã€ç›‘æ§æŒ‡æ ‡" tabindex="-1">äº”ã€ç›‘æ§æŒ‡æ ‡ <a class="header-anchor" href="#äº”ã€ç›‘æ§æŒ‡æ ‡" aria-label="Permalink to &quot;äº”ã€ç›‘æ§æŒ‡æ ‡&quot;">â€‹</a></h2><h3 id="_5-1-æ ¸å¿ƒæŒ‡æ ‡" tabindex="-1">5.1 æ ¸å¿ƒæŒ‡æ ‡ <a class="header-anchor" href="#_5-1-æ ¸å¿ƒæŒ‡æ ‡" aria-label="Permalink to &quot;5.1 æ ¸å¿ƒæŒ‡æ ‡&quot;">â€‹</a></h3><table tabindex="0"><thead><tr><th>æŒ‡æ ‡ç±»å‹</th><th>æŒ‡æ ‡å</th><th>è®¡ç®—æ–¹å¼</th><th>ä½œç”¨</th></tr></thead><tbody><tr><td><strong>è¯·æ±‚</strong></td><td>ä¼šè¯æ•°</td><td>COUNT(DISTINCT thread_id)</td><td>æ€»ä¼šè¯é‡</td></tr><tr><td><strong>è¯·æ±‚</strong></td><td>æ–°ä¼šè¯æ•°</td><td>COUNT WHERE is_new=true</td><td>æ–°ç”¨æˆ·æ´»è·ƒåº¦</td></tr><tr><td><strong>è¯·æ±‚</strong></td><td>è¯·æ±‚æ•°</td><td>COUNT(trace_id)</td><td>æ€»è¯·æ±‚é‡</td></tr><tr><td><strong>æˆåŠŸç‡</strong></td><td>é¦–æ¬¡ä»»åŠ¡å®Œæˆç‡</td><td>(å®Œæˆæ•° / æ€»è¯·æ±‚æ•°) * 100%</td><td>ä»»åŠ¡å®Œç»“æƒ…å†µ</td></tr><tr><td><strong>æˆåŠŸç‡</strong></td><td>å·¥å…·è°ƒç”¨æ€»æˆåŠŸç‡</td><td>(æˆåŠŸæ•° / æ€»è°ƒç”¨æ•°) * 100%</td><td>å·¥å…·æ•´ä½“å¯ç”¨æ€§</td></tr><tr><td><strong>æˆåŠŸç‡</strong></td><td>å•å·¥å…·è°ƒç”¨æˆåŠŸç‡</td><td>(è¯¥å·¥å…·æˆåŠŸæ•° / è¯¥å·¥å…·è°ƒç”¨æ•°) * 100%</td><td>å•ä¸ªå·¥å…·å¯ç”¨æ€§</td></tr><tr><td><strong>å»¶è¿Ÿ</strong></td><td>é¦–å“åº”å»¶è¿Ÿ P99</td><td>P99(é¦–æ¡ Response æ—¶é—´)</td><td>ç”¨æˆ·ä½“éªŒ</td></tr><tr><td><strong>å»¶è¿Ÿ</strong></td><td>è¯·æ±‚å¤„ç†æ—¶é•¿ P99</td><td>P99(request_execute_end - request_execute_begin)</td><td>æ•´ä½“æ€§èƒ½</td></tr><tr><td><strong>å»¶è¿Ÿ</strong></td><td>LLM å“åº”æ—¶é•¿ P99</td><td>P99(llm_execute_end - llm_execute_begin)</td><td>LLM æ€§èƒ½</td></tr><tr><td><strong>å»¶è¿Ÿ</strong></td><td>å·¥å…·è°ƒç”¨æ—¶é•¿ P99</td><td>P99(tool_execute_end - tool_execute_begin)</td><td>å·¥å…·æ€§èƒ½</td></tr><tr><td><strong>æˆæœ¬</strong></td><td>Token æ¶ˆè€—</td><td>SUM(prompt_tokens + completion_tokens)</td><td>LLM æˆæœ¬</td></tr><tr><td><strong>æˆæœ¬</strong></td><td>ç¨¿è±†æ¶ˆè€—</td><td>SUM(deduct_points)</td><td>å·¥å…·æˆæœ¬</td></tr><tr><td><strong>ä¸šåŠ¡</strong></td><td>æŠ€èƒ½ä½¿ç”¨ç‡</td><td>COUNT BY input_skill_id</td><td>æŠ€èƒ½çƒ­åº¦</td></tr><tr><td><strong>ä¸šåŠ¡</strong></td><td>æ¨¡å¼ä½¿ç”¨ç‡</td><td>COUNT BY mode</td><td>æ¨¡å¼åå¥½</td></tr><tr><td><strong>ä¸šåŠ¡</strong></td><td>é‡‡çº³ç‡</td><td>(ä¸‹è½½æ•° / å®Œæˆæ•°) * 100%</td><td>ç”¨æˆ·æ»¡æ„åº¦</td></tr><tr><td><strong>ä¸šåŠ¡</strong></td><td>ä»»åŠ¡æœªå®Œæˆç‡</td><td>(ä¸­æ–­æ•° / æ€»è¯·æ±‚æ•°) * 100%</td><td>ç”¨æˆ·æµå¤±</td></tr></tbody></table><hr><h2 id="å…­ã€å‘Šè­¦è§„åˆ™" tabindex="-1">å…­ã€å‘Šè­¦è§„åˆ™ <a class="header-anchor" href="#å…­ã€å‘Šè­¦è§„åˆ™" aria-label="Permalink to &quot;å…­ã€å‘Šè­¦è§„åˆ™&quot;">â€‹</a></h2><h3 id="_6-1-å‘Šè­¦é…ç½®" tabindex="-1">6.1 å‘Šè­¦é…ç½® <a class="header-anchor" href="#_6-1-å‘Šè­¦é…ç½®" aria-label="Permalink to &quot;6.1 å‘Šè­¦é…ç½®&quot;">â€‹</a></h3><table tabindex="0"><thead><tr><th>æŒ‡æ ‡å</th><th>å‘Šè­¦è§„åˆ™</th><th>å‘Šè­¦çº§åˆ«</th><th>ä¸‹ä¸€æ­¥</th></tr></thead><tbody><tr><td><strong>å¯¹è¯è¯·æ±‚æˆåŠŸç‡</strong></td><td>è¿‘ 5 åˆ†é’Ÿ &lt; 50%</td><td>P0</td><td>ä¼šè¯å¼‚å¸¸ç»“æŸåŸå› åˆ†æ</td></tr><tr><td><strong>å·¥å…·è°ƒç”¨æ€»æˆåŠŸç‡</strong></td><td>è¿‘ 5 åˆ†é’Ÿ &lt; 50%</td><td>P1</td><td>å·¥å…·è°ƒç”¨å¤±è´¥åŸå› åˆ†æã€å·¥å…· QPS æ£€æŸ¥</td></tr><tr><td><strong>å•å·¥å…·è°ƒç”¨æˆåŠŸç‡</strong></td><td>è¿‘ 5 åˆ†é’Ÿ &lt; 50%</td><td>P1</td><td>å•å·¥å…·æ•…éšœåˆ†æ</td></tr><tr><td><strong>é¦–å“åº”å»¶è¿Ÿ</strong></td><td>è¿‘ 5 åˆ†é’Ÿ P99 &gt; 10s ä¸”å æ¯” &gt; 20%</td><td>P1</td><td>ç³»ç»Ÿæ‰©å®¹ / Graph ä¼˜åŒ– / é€‰æ‹©æ›´å¿«çš„ LLM</td></tr><tr><td><strong>æ ‡é¢˜ç”ŸæˆæˆåŠŸç‡</strong></td><td>è¿‘ 5 åˆ†é’Ÿ &lt; 50%</td><td>P2</td><td>gdesign-tool è°ƒç”¨ Dify é“¾è·¯åˆ†æã€Dify workflow é”™è¯¯åˆ†æ</td></tr><tr><td><strong>Auth Key åˆ·æ–°æˆåŠŸç‡</strong></td><td>è¿‘ 10 åˆ†é’Ÿå‡å¤±è´¥</td><td>P0</td><td>FileMS æ˜¯å¦æ­£å¸¸ã€Redis æ˜¯å¦æ­£å¸¸</td></tr></tbody></table><h3 id="_6-2-å‘Šè­¦åˆ†çº§" tabindex="-1">6.2 å‘Šè­¦åˆ†çº§ <a class="header-anchor" href="#_6-2-å‘Šè­¦åˆ†çº§" aria-label="Permalink to &quot;6.2 å‘Šè­¦åˆ†çº§&quot;">â€‹</a></h3><table tabindex="0"><thead><tr><th>çº§åˆ«</th><th>å“åº”æ—¶é—´</th><th>å½±å“èŒƒå›´</th></tr></thead><tbody><tr><td><strong>P0</strong></td><td>5 åˆ†é’Ÿ</td><td>æ ¸å¿ƒåŠŸèƒ½ä¸å¯ç”¨</td></tr><tr><td><strong>P1</strong></td><td>15 åˆ†é’Ÿ</td><td>é‡è¦åŠŸèƒ½å—å½±å“</td></tr><tr><td><strong>P2</strong></td><td>30 åˆ†é’Ÿ</td><td>æ¬¡è¦åŠŸèƒ½å¼‚å¸¸</td></tr></tbody></table><hr><h2 id="ä¸ƒã€æ—¥å¿—é‡‡é›†" tabindex="-1">ä¸ƒã€æ—¥å¿—é‡‡é›† <a class="header-anchor" href="#ä¸ƒã€æ—¥å¿—é‡‡é›†" aria-label="Permalink to &quot;ä¸ƒã€æ—¥å¿—é‡‡é›†&quot;">â€‹</a></h2><h3 id="_7-1-æ—¥å¿—æ ¼å¼" tabindex="-1">7.1 æ—¥å¿—æ ¼å¼ <a class="header-anchor" href="#_7-1-æ—¥å¿—æ ¼å¼" aria-label="Permalink to &quot;7.1 æ—¥å¿—æ ¼å¼&quot;">â€‹</a></h3><div class="language-json vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">json</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">{</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  &quot;timestamp&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;2025-07-08T12:00:00Z&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  &quot;level&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;INFO&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  &quot;event&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;request_execute_begin&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  &quot;trace_id&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;trace_123&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  &quot;thread_id&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;thread_abc&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  &quot;user_id&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;user_456&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  &quot;module&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;Gaoding-AI-Agent&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  &quot;data&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: {</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    &quot;text&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;å¸®æˆ‘ç”Ÿæˆä¸€å¼ ç‰™è†äº§å“å›¾&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    &quot;is_new&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">true</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br></div></div><h3 id="_7-2-æ—¥å¿—çº§åˆ«" tabindex="-1">7.2 æ—¥å¿—çº§åˆ« <a class="header-anchor" href="#_7-2-æ—¥å¿—çº§åˆ«" aria-label="Permalink to &quot;7.2 æ—¥å¿—çº§åˆ«&quot;">â€‹</a></h3><table tabindex="0"><thead><tr><th>çº§åˆ«</th><th>ç”¨é€”</th></tr></thead><tbody><tr><td><strong>DEBUG</strong></td><td>è°ƒè¯•ä¿¡æ¯ï¼ˆä»…å¼€å‘ç¯å¢ƒï¼‰</td></tr><tr><td><strong>INFO</strong></td><td>æ­£å¸¸æµç¨‹æ—¥å¿—</td></tr><tr><td><strong>WARNING</strong></td><td>è­¦å‘Šä¿¡æ¯ï¼ˆé™çº§ã€é‡è¯•ï¼‰</td></tr><tr><td><strong>ERROR</strong></td><td>é”™è¯¯ä¿¡æ¯</td></tr><tr><td><strong>CRITICAL</strong></td><td>ä¸¥é‡é”™è¯¯</td></tr></tbody></table><h3 id="_7-3-æ•æ„Ÿä¿¡æ¯å¤„ç†" tabindex="-1">7.3 æ•æ„Ÿä¿¡æ¯å¤„ç† <a class="header-anchor" href="#_7-3-æ•æ„Ÿä¿¡æ¯å¤„ç†" aria-label="Permalink to &quot;7.3 æ•æ„Ÿä¿¡æ¯å¤„ç†&quot;">â€‹</a></h3><p><strong>è„±æ•è§„åˆ™ï¼š</strong></p><ul><li><code>original_messages</code> / <code>llm_messages</code>ï¼šä»…åœ¨é prod ç¯å¢ƒä¸ŠæŠ¥</li><li>ç”¨æˆ·è¾“å…¥ï¼šä¸è®°å½•æ•æ„Ÿè¯</li><li>API Keyï¼šæ°¸ä¸è®°å½•</li></ul><hr><h2 id="å…«ã€å®ç°ç¤ºä¾‹" tabindex="-1">å…«ã€å®ç°ç¤ºä¾‹ <a class="header-anchor" href="#å…«ã€å®ç°ç¤ºä¾‹" aria-label="Permalink to &quot;å…«ã€å®ç°ç¤ºä¾‹&quot;">â€‹</a></h2><h3 id="_8-1-æ—¥å¿—è®°å½•" tabindex="-1">8.1 æ—¥å¿—è®°å½• <a class="header-anchor" href="#_8-1-æ—¥å¿—è®°å½•" aria-label="Permalink to &quot;8.1 æ—¥å¿—è®°å½•&quot;">â€‹</a></h3><div class="language-python vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">import</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> logging</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">import</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> json</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">from</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> datetime </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">import</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> datetime</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">def</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> log_checkpoint</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(event, trace_id, thread_id, user_id, data):</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">    &quot;&quot;&quot;è®°å½• checkpoint æ—¥å¿—&quot;&quot;&quot;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    log_entry </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">        &quot;timestamp&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: datetime.utcnow().isoformat() </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">+</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;Z&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">        &quot;level&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;INFO&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">        &quot;event&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: event,</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">        &quot;trace_id&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: trace_id,</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">        &quot;thread_id&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: thread_id,</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">        &quot;user_id&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: user_id,</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">        &quot;module&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;Gaoding-AI-Agent&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">        &quot;data&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: data</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    logging.info(json.dumps(log_entry))</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># ä½¿ç”¨ç¤ºä¾‹</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">log_checkpoint(</span></span>
<span class="line"><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">    event</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;request_execute_begin&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">    trace_id</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;trace_123&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">    thread_id</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;thread_abc&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">    user_id</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;user_456&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">    data</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">{</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">        &quot;text&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;å¸®æˆ‘ç”Ÿæˆä¸€å¼ ç‰™è†äº§å“å›¾&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">        &quot;is_new&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">True</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">        &quot;input_skill_id&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">2</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br></div></div><h3 id="_8-2-æŒ‡æ ‡ä¸ŠæŠ¥" tabindex="-1">8.2 æŒ‡æ ‡ä¸ŠæŠ¥ <a class="header-anchor" href="#_8-2-æŒ‡æ ‡ä¸ŠæŠ¥" aria-label="Permalink to &quot;8.2 æŒ‡æ ‡ä¸ŠæŠ¥&quot;">â€‹</a></h3><div class="language-python vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">from</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> prometheus_client </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">import</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> Counter, Histogram, Gauge</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># å®šä¹‰æŒ‡æ ‡</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">request_total </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> Counter(</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">    &#39;agent_request_total&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">    &#39;Total number of requests&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    [</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;status&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;skill_id&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">request_duration </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> Histogram(</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">    &#39;agent_request_duration_seconds&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">    &#39;Request duration in seconds&#39;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">llm_tokens </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> Counter(</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">    &#39;agent_llm_tokens_total&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">    &#39;Total LLM tokens consumed&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    [</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;token_type&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;model&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># ä½¿ç”¨ç¤ºä¾‹</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">request_total.labels(</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">status</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;success&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">skill_id</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;2&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">).inc()</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">request_duration.observe(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">5.2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">llm_tokens.labels(</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">token_type</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;prompt&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">model</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;doubao&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">).inc(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">150</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br></div></div><hr><h2 id="ä¹ã€æ•°æ®åˆ†æ" tabindex="-1">ä¹ã€æ•°æ®åˆ†æ <a class="header-anchor" href="#ä¹ã€æ•°æ®åˆ†æ" aria-label="Permalink to &quot;ä¹ã€æ•°æ®åˆ†æ&quot;">â€‹</a></h2><h3 id="_9-1-å…³é”®æŸ¥è¯¢" tabindex="-1">9.1 å…³é”®æŸ¥è¯¢ <a class="header-anchor" href="#_9-1-å…³é”®æŸ¥è¯¢" aria-label="Permalink to &quot;9.1 å…³é”®æŸ¥è¯¢&quot;">â€‹</a></h3><p><strong>ä¼šè¯ç»Ÿè®¡ï¼š</strong></p><div class="language-sql vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">SELECT</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> </span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    DATE</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">timestamp</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">as</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> date</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    COUNT</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">DISTINCT</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> thread_id) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">as</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> total_threads,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    COUNT</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">DISTINCT</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> CASE</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> WHEN</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> is_new </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">THEN</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> thread_id </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">END</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">as</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> new_threads</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">FROM</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> agent_logs</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">WHERE</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> event</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;request_execute_begin&#39;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">GROUP BY</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> date</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">ORDER BY</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> date</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> DESC</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><p><strong>æˆåŠŸç‡åˆ†æï¼š</strong></p><div class="language-sql vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">SELECT</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> </span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    func_name,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    COUNT</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">*</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">as</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> total_calls,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    SUM</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">CASE</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> WHEN</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> result </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;success&#39;</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> THEN</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 1</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> ELSE</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 0</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> END</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">as</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> success_calls,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    ROUND</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">100</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> *</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> SUM</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">CASE</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> WHEN</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> result </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;success&#39;</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> THEN</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 1</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> ELSE</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 0</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> END</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">/</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> COUNT</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">*</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">), </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">as</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> success_rate</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">FROM</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> agent_logs</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">WHERE</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> event</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;tool_execute_end&#39;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">GROUP BY</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> func_name</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">ORDER BY</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> total_calls </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">DESC</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><p><strong>æˆæœ¬åˆ†æï¼š</strong></p><div class="language-sql vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">SELECT</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> </span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    DATE</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">timestamp</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">as</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> date</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    SUM</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(prompt_tokens </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">+</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> completion_tokens) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">as</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> total_tokens,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    SUM</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(deduct_points) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">as</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> total_points</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">FROM</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> agent_logs</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">WHERE</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> event</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> IN</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;llm_execute_end&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;tool_execute_end&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">GROUP BY</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> date</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">ORDER BY</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> date</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> DESC</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><hr><h2 id="åã€æ€»ç»“" tabindex="-1">åã€æ€»ç»“ <a class="header-anchor" href="#åã€æ€»ç»“" aria-label="Permalink to &quot;åã€æ€»ç»“&quot;">â€‹</a></h2><h3 id="_10-1-æ ¸å¿ƒè®¾è®¡" tabindex="-1">10.1 æ ¸å¿ƒè®¾è®¡ <a class="header-anchor" href="#_10-1-æ ¸å¿ƒè®¾è®¡" aria-label="Permalink to &quot;10.1 æ ¸å¿ƒè®¾è®¡&quot;">â€‹</a></h3><ol><li><strong>å®Œæ•´é“¾è·¯è¿½è¸ª</strong>ï¼šè¦†ç›–è¯·æ±‚å…¨ç”Ÿå‘½å‘¨æœŸ</li><li><strong>ç²¾ç»†åŒ–æŒ‡æ ‡</strong>ï¼šæ”¯æŒæˆæœ¬ç®¡æ§å’Œæ€§èƒ½ä¼˜åŒ–</li><li><strong>åˆ†çº§å‘Šè­¦</strong>ï¼šå¿«é€Ÿå‘ç°å’Œå“åº”é—®é¢˜</li><li><strong>æ•°æ®é©±åŠ¨</strong>ï¼šæ”¯æ’‘ä¸šåŠ¡å†³ç­–</li></ol><h3 id="_10-2-å…³é”®èƒ½åŠ›" tabindex="-1">10.2 å…³é”®èƒ½åŠ› <a class="header-anchor" href="#_10-2-å…³é”®èƒ½åŠ›" aria-label="Permalink to &quot;10.2 å…³é”®èƒ½åŠ›&quot;">â€‹</a></h3><ul><li>âœ… é“¾è·¯è¿½è¸ªï¼štrace_id è´¯ç©¿å…¨é“¾è·¯</li><li>âœ… æ€§èƒ½ç›‘æ§ï¼šå»¶è¿Ÿã€æˆåŠŸç‡ã€ååé‡</li><li>âœ… æˆæœ¬ç®¡æ§ï¼šToken å’Œç¨¿è±†æ¶ˆè€—</li><li>âœ… ä¸šåŠ¡æ´å¯Ÿï¼šæŠ€èƒ½ä½¿ç”¨ã€ç”¨æˆ·è¡Œä¸º</li></ul><hr><p><em>æ–‡æ¡£ç‰ˆæœ¬ï¼šv1.0</em><br><em>æœ€åæ›´æ–°ï¼š2025-01-26</em></p>`,101))])}const q=e(o,[["render",g]]);export{_ as __pageData,q as default};
